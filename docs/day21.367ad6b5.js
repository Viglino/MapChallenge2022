function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},o={},r=t.parcelRequirecc54;null==r&&((r=function(e){if(e in i)return i[e].exports;if(e in o){var t=o[e];delete o[e];var r={id:e,exports:{}};return i[e]=r,t.call(r.exports,r,r.exports),r.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){o[e]=t},t.parcelRequirecc54=r);var s=r("6gELa"),a=r("2zf1Y"),n=r("3hQzq"),h=r("kPMpK"),d=class extends h.default{constructor(e){super(e=e||{}),this._hash={},this._count=0,this._extended=e.extended,"function"==typeof e.whiteList?this._whiteList=e.whiteList:e.whiteList&&e.whiteList.indexOf?this._whiteList=function(t){return e.whiteList.indexOf(t)>-1}:this._whiteList=function(){return!0},"function"==typeof e.blackList?this._blackList=e.blackList:e.blackList&&e.blackList.indexOf?this._blackList=function(t){return e.blackList.indexOf(t)>-1}:this._blackList=function(){return!1},this._deleteNull=!1!==e.deleteNullProperties&&[null,void 0,""];var t=2;e.dataProjection&&"EPSG:4326"!==e.dataProjection||(t=7),isNaN(parseInt(e.decimals))||(t=parseInt(e.decimals)),this._decimals=t,this.setLayout(e.layout||"XY")}setLayout(e){switch(e){case"XYZ":case"XYZM":this._layout=e;break;default:this._layout="XY"}}getLayout(){return this._layout}encodeNumber(e,t){!isNaN(Number(e))&&null!==e&&isFinite(e)||(e=0),t||0===t||(t=this._decimals),(e=Math.round(e*Math.pow(10,t)))<0?e=-2*e-1:e*=2;for(var i,o="",r=e;i=r%this._size,o=this._radix.charAt(i)+o,0!=(r=Math.floor(r/this._size)););return o}decodeNumber(e,t){t||0===t||(t=this._decimals);var i=0;e.split("").forEach(function(e){i=i*this._size+this._radix.indexOf(e)}.bind(this));var o=Math.floor(i/2);return o!==i/2&&(o=-1-o),o/Math.pow(10,t)}encodeCoordinates(e,t){var i,o,r;if("number"==typeof e[0])return o=this.encodeNumber(e[0],t)+","+this.encodeNumber(e[1],t),"Z"==this._layout[2]&&e.length>2&&(o+=","+this.encodeNumber(e[2],2)),"M"==this._layout[3]&&e.length>3&&(o+=","+this.encodeNumber(e[3],0)),o;if(e.length&&e[0]){if("number"==typeof e[0][0]){var s=[0,0,0,0],a=[],n="Z"==this._layout[2]&&e[0].length>2,h="M"==this._layout[3]&&e[0].length>3;for(i=0;i<e.length;i++){r=[Math.round(e[i][0]*Math.pow(10,t)),Math.round(e[i][1]*Math.pow(10,t))],n&&(r[2]=e[i][2]),h&&(r[3]=e[i][3]),e[i]=r;var d=e[i][0]-s[0],l=e[i][1]-s[1];0!=i&&0===d&&0===l||(o=this.encodeNumber(d,0)+","+this.encodeNumber(l,0)+(n?","+this.encodeNumber(e[i][2]-s[2],2):"")+(h?","+this.encodeNumber(e[i][3]-s[3],0):""),a.push(o),s=e[i])}return a.length<2&&e.length>1&&(o="A,A"+(n?",A":"")+(h?",A":""),a.push(o)),a.join(";")}for(i=0;i<e.length;i++)e[i]=this.encodeCoordinates(e[i],t);return e}return this.encodeCoordinates([0,0],t)}decodeCoordinates(e,t){var i,o;if("string"==typeof e){if((e=e.split(";")).length>1){var r=Math.pow(10,t),s=[0,0,0,0];return e.forEach(function(i,o){e[o]=i.split(","),e[o][0]=Math.round((this.decodeNumber(e[o][0],t)+s[0])*r)/r,e[o][1]=Math.round((this.decodeNumber(e[o][1],t)+s[1])*r)/r,e[o].length>2&&(e[o][2]=Math.round((this.decodeNumber(e[o][2],2)+s[2])*r)/r),e[o].length>3&&(e[o][3]=Math.round((this.decodeNumber(e[o][3],0)+s[3])*r)/r),s=e[o]}.bind(this)),e}return e=e[0].split(","),o=[this.decodeNumber(e[0],t),this.decodeNumber(e[1],t)],e.length>2&&(o[2]=this.decodeNumber(e[2],2)),e.length>3&&(o[3]=this.decodeNumber(e[3],0)),o}if(e.length){var a=[];for(i=0;i<e.length;i++)a[i]=this.decodeCoordinates(e[i],t);return a}return[0,0]}writeFeaturesObject(e,t){t=t||{},this._count=0,this._hash={};var i=h.default.prototype.writeFeaturesObject.call(this,e,t);i.decimals=this._decimals,i.hashProperties=[],Object.keys(this._hash).forEach(function(e){i.hashProperties.push(e)}.bind(this)),this._count=0,this._hash={};var o=i.features;return delete i.features,i.features=o,i}writeFeatureObject(e,t){var i=h.default.prototype.writeFeatureObject.call(this,e,t);if("Feature"!==i.type)throw"GeoJSONX doesn't support "+i.type+".";var o,r=[];if("Point"===i.geometry.type)r.push(this.encodeCoordinates(i.geometry.coordinates,this._decimals));else if("MultiPoint"===i.geometry.type){var s=[];i.geometry.coordinates.forEach(function(e){s.push(this.encodeCoordinates(e,this._decimals))}.bind(this)),r.push([this._type[i.geometry.type],s.join(";")])}else{if(!this._type[i.geometry.type])throw"GeoJSONX doesn't support "+i.geometry.type+".";r.push([this._type[i.geometry.type],this.encodeCoordinates(i.geometry.coordinates,this._decimals)])}var a=[];for(o in i.properties)this._whiteList(o)&&!this._blackList(o)&&(this._hash.hasOwnProperty(o)||(this._hash[o]=this._count,this._count++),(!this._deleteNull||this._deleteNull.indexOf(i.properties[o])<0)&&a.push(this._hash[o],i.properties[o]));if((a.length||this._extended)&&r.push(a),this._extended){var n=!1;for(o in a={},i)/^type$|^geometry$|^properties$/.test(o)||(a[o]=i[o],n=!0);n&&r.push(a)}return r}writeGeometryObject(e,t){var i=h.default.prototype.writeGeometryObject.call(this,e,t);return"Point"===i.type?this.encodeCoordinates(i.coordinates,this._decimals):[this._type[i.type],this.encodeCoordinates(i.coordinates,this._decimals)]}readFeaturesFromObject(e,t){if(this._hashProperties=e.hashProperties||[],(t=t||{}).decimals=parseInt(e.decimals),!t.decimals&&0!==t.decimals)throw"Bad file format...";return h.default.prototype.readFeaturesFromObject.call(this,e,t)}readFeatureFromObject(e,t){var i={type:"Feature"};if("string"==typeof e[0])i.geometry={type:"Point",coordinates:this.decodeCoordinates(e[0],"number"==typeof t.decimals?t.decimals:this.decimals)};else if(i.geometry={type:this._toType[e[0][0]]},"MultiPoint"===i.geometry.type){var o=i.geometry.coordinates=[];e[0][1].split(";").forEach(function(e){e=e.split(","),o.push([this.decodeNumber(e[0],t.decimals),this.decodeNumber(e[1],t.decimals)])}.bind(this))}else i.geometry.coordinates=this.decodeCoordinates(e[0][1],"number"==typeof t.decimals?t.decimals:this.decimals);if(this._hashProperties&&e[1]){i.properties={};for(var r=e[1],s=0;s<r.length;s+=2)i.properties[this._hashProperties[r[s]]]=r[s+1]}else i.properties=e[1];if(e[2])for(var a in e[2])i[a]=e[2][a];return h.default.prototype.readFeatureFromObject.call(this,i,t)}};d.prototype._radix="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ !#$%&'()*-.:<=>?@[]^_`{|}~",d.prototype._size=d.prototype._radix.length,d.prototype._type={Point:0,LineString:1,Polygon:2,MultiPoint:3,MultiLineString:4,MultiPolygon:5,GeometryCollection:null},d.prototype._toType=["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"];var l=d,u=r("7qsnY"),c=r("20LS2"),p=r("1B70O"),f=r("jZUWm");var y=r("l9IGS"),m=r("6yJ0x"),g=r("5VeMq");(0,f.default)(e('<div> <h2> Day 2: lines Flow lines style </h2> <p> Use <a href="http://viglino.github.io/ol-ext/doc/doc-pages/ol.source.HexBin.html" target="_new">ol-ext hexagonal bin</a> to display Kontour population at lower zoom level </p> </div>')),p.default.getView().setZoom(6),p.default.getView().setCenter([253080,5857122]);const _=new(0,s.default)({layer:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",opacity:.8});p.default.addLayer(_);const b=[];function w(e){if(e=Math.round(e/100),!b[e]){let t=Math.min(1,e/300);t=Math.pow(Math.sin(t*Math.PI/2),.5),t<.25?(t*=4,b[e]=new(0,y.default)({fill:new(0,a.default)({color:[180*(1-t)+255*t,180*(1-t)+255*t,200*(1-t)+220*t,1]})})):(t=4*(t-.25)/3,b[e]=new(0,y.default)({fill:new(0,a.default)({color:[255*(1-t)+128*t,255*(1-t)+0*t,220*(1-t)+25*t]})}))}return b[e]}const v=new(0,c.default)({attributions:["<a href='https://data.humdata.org/dataset/kontur-population-dataset'>Kontur &copy; CC-By-SA</a>"]}),N=new(0,u.default)({className:"kontur",style:e=>w(e.get("population")),minZoom:10});p.default.addLayer(N),document.body.classList.add("loading"),fetch("https://viglino.github.io/maps/static/kontur-pop/france.geojsonx").then((e=>e.text())).then((e=>{const t=(new l).readFeatures(e,{featureProjection:p.default.getView().getProjection()});v.addFeatures(t),N.setSource(v),document.body.classList.remove("loading")}));const L=new(0,n.default)({source:v,size:5e3,maxZoom:10}),M=new(0,u.default)({title:"Bin",className:"bin",source:L,style:e=>{let t=0;return e.get("features").forEach((e=>{t+=e.get("population")})),t/=e.get("features").length,w(t)},maxZoom:10});p.default.addLayer(M);const P=new(0,g.default)({positioning:"bottom-center"});p.default.addOverlay(P);const x=new(0,m.default)({cursor:"pointer",hitTolerance:2});x.on("leave",(()=>{P.hide()})),x.on("hover",(e=>{const t=e.feature;if(t){const i=t.get("population")||t.get("features")[0].get("population");P.show(e.coordinate,"pop: "+i)}else P.hide()})),p.default.addInteraction(x);