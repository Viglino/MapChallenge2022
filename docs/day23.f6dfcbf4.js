function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},i={},s=t.parcelRequirecc54;null==s&&((s=function(e){if(e in a)return a[e].exports;if(e in i){var t=i[e];delete i[e];var s={id:e,exports:{}};return a[e]=s,t.call(s.exports,s,s.exports),s.exports}var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){i[e]=t},t.parcelRequirecc54=s);var n=s("6gELa"),r=s("610XN"),o=s("20LS2"),h=s("apY9r"),d=s("gYm1x"),l=s("1B70O"),c=s("jZUWm");var u=s("VCbYw"),g=s("ejLRd"),p=s("iQyfo"),m=s("fnScq");window.ol&&!ol.particule&&(ol.particule={});var f=class extends m.default{constructor(e){super(e=e||{}),this.setOverlay(e.overlay),this.coordinate=e.coordinate||[0,0]}setOverlay(e){this._overlay=e}getOverlay(){return this._overlay}draw(){}update(){}getRandomCoord(e){return this.getOverlay().randomCoord?this.getOverlay().randomCoord():[e,0]}},w=class extends u.default{constructor(e){e=e||{};var t=p.default.create("CANVAS",{className:((e.className||"")+" ol-animated-overlay").trim()});super({element:t,stopEvent:!1}),this._canvas=t,this._ctx=this._canvas.getContext("2d"),this._listener=[],this._time=0,this._particuleClass=e.particule||f,e.createParticule&&(this._createParticule=e.createParticule),this._fps=1e3/(e.fps||25);var a=this._createParticule();this._psize=a.get("size")||[50,50],this.set("density",e.density||.5),this.set("speed",e.speed||4),this.set("angle","number"==typeof e.angle?e.angle:Math.PI/4),!1!==e.animate&&this.setAnimation(!0),document.addEventListener("visibilitychange",function(){this._pause=!0}.bind(this))}setVisible(e){this.element.style.display=e?"block":"none",e&&this.setAnimation(this.get("animation"))}getVisible(){return"none"!=this.element.style.display}updatePixelPosition(){}setMap(e){if(this.getMap()&&this.getMap().getViewport().querySelector(".ol-overlaycontainer").removeChild(this._canvas),this._listener.forEach((function(e){(0,g.unByKey)(e)})),this._listener=[],super.setMap(e),e){var t=e.getSize();this._canvas.width=t[0],this._canvas.height=t[1],this.draw(),this._listener.push(e.on("change:size",function(){var t=e.getSize();this._canvas.width===t[0]&&this._canvas.height===t[1]||(this._canvas.width=t[0],this._canvas.height=t[1],this.draw())}.bind(this)))}}getParticules(){var e=this._psize[0],t=this._psize[1],a=this.get("density")*this._canvas.width*this._canvas.height/e/t<<0;if(this._particules||(this._particules=[]),a>this._particules.length)for(var i=this._particules.length;i<a;i++)this._particules.push(this._createParticule(this,this.randomCoord()));else this._particules.length=a;return this._particules}_createParticule(e,t){return new this._particuleClass({overlay:e,coordinate:t})}randomCoord(){return[Math.random()*(this._canvas.width+this._psize[0])-this._psize[0]/2,Math.random()*(this._canvas.height+this._psize[1])-this._psize[1]/2]}draw(e){var t=this._ctx;this.clear(),t.beginPath(),this.getParticules().forEach(function(t){e&&(t.update(e),this.testExit(t)),t.draw(this._ctx)}.bind(this))}testExit(e){var t=this._psize;e.coordinate[0]<-t[0]?(e.coordinate[0]=this._canvas.width+t[0],e.coordinate[1]=Math.random()*(this._canvas.height+t[1])-t[1]/2):e.coordinate[0]>this._canvas.width+t[0]?(e.coordinate[0]=-t[0],e.coordinate[1]=Math.random()*(this._canvas.height+t[1])-t[1]/2):e.coordinate[1]<-t[1]?(e.coordinate[0]=Math.random()*(this._canvas.width+t[0])-t[0]/2,e.coordinate[1]=this._canvas.height+t[1]):e.coordinate[1]>this._canvas.height+t[1]&&(e.coordinate[0]=Math.random()*(this._canvas.width+t[0])-t[0]/2,e.coordinate[1]=-t[1])}clear(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)}getCanvas(){return this._canvas}setAnimation(e){e=!1!==e,this.set("animation",e),e?(this._pause=!0,requestAnimationFrame(this._animate.bind(this))):this.dispatchEvent({type:"animation:stop",time:this._time})}_animate(e){this.getVisible()&&this.get("animation")&&(this._pause?requestAnimationFrame(function(e){this._time=e,requestAnimationFrame(this._animate.bind(this))}.bind(this)):(e-this._time>this._fps&&(this.draw(e-this._time),this._time=e),requestAnimationFrame(this._animate.bind(this)))),this._pause=!1}},v=class extends f{constructor(e){super(e=e||{}),this.set("size",[100,100]);var t=document.createElement("CANVAS");t.width=200,t.height=200;var a=t.getContext("2d"),i=this.gradient=a.createRadialGradient(50,50,0,50,50,50);i.addColorStop(0,"rgba(255,255,255,.2"),i.addColorStop(1,"rgba(255,255,255,0"),this.image=t;for(var s=0;s<7;s++){a.save();var n=100*Math.random(),r=100*Math.random();a.translate(n,r),a.fillStyle=i,a.fillRect(0,0,t.width,t.height),a.restore()}}draw(e){e.save(),e.translate(this.coordinate[0],this.coordinate[1]),e.drawImage(this.image,-this.image.width/2,-this.image.width/2),e.restore()}update(e){var t=this.getOverlay().get("speed")*e/this.getOverlay()._fps,a=this.getOverlay().get("angle");this.coordinate[0]+=t*Math.cos(a),this.coordinate[1]+=t*Math.sin(a)}};p=s("iQyfo");(0,c.default)(e('<div> <h2> Day 23: Movement </h2> <p> Fly over the map! <br> Use buttons or keybord keys to move the plane. </p> <p> Plane sprite pack form <a href="https://unluckystudio.com/free-game-artassets-for-games-12-top-down-planes-sprites-pack/">Unlucky studio.</a> </p> </div>')),l.permalink.setUrlReplace(!1),l.default.getView().setZoom(15),l.default.getView().setCenter([-129695,5805721]);const _=new(0,h.default)({map:l.default});window.game=_;const y=new(0,n.default)({preload:1/0,layer:"ORTHOIMAGERY.ORTHOPHOTOS"});_.getMap().addLayer(y);const b=new(0,r.default)({source:new(0,o.default)});l.default.addLayer(b);let V=-Math.PI/2,M=l.default.getView().getCenter();const C=new(0,d.default)({position:l.default.getView().getCenter(),src:"https://viglino.github.io/ol-games/examples/data/plane.png",size:175,scale:.5,frameRate:10,states:{idle:{line:0,length:3}}});b.getSource().addFeature(C);const x=new(0,d.default)({position:l.default.getView().getCenter(),src:"https://viglino.github.io/ol-games/examples/img/Biploar_shadow.png",size:200,scale:.3,frameRate:10,states:{idle:{line:0,length:0}}});b.getSource().addFeature(x),x.getStyle()[0].setZIndex(-1),x.getStyle()[0].getImage().setOpacity(.5),window.shadow=x,_.on("render",(function(e){V+=I,M[0]+=.2*e.dt*Math.cos(V),M[1]-=.2*e.dt*Math.sin(V),_.getView().setCenter(M),l.default.getView().getZoom()<P?l.default.getView().setZoom(Math.min(P,l.default.getView().getZoom()+e.dt/5e3)):l.default.getView().getZoom()>P&&l.default.getView().setZoom(Math.max(P,l.default.getView().getZoom()-e.dt/5e3)),C.getGeometry().setCoordinates(M),C.getStyle()[0].getImage().setRotation(V+Math.PI/2),C.getStyle()[0].getImage().setScale(.5+.02*l.default.getView().getResolution()),C.update(e),x.getGeometry().setCoordinates([M[0]+30*l.default.getView().getResolution(),M[1]-40*l.default.getView().getResolution()]),x.getStyle()[0].getImage().setScale(.4+.03*(1-l.default.getView().getResolution())),x.getStyle()[0].getImage().setRotation(V+Math.PI/2)})),_.start();let I=0,P=l.default.getView().getZoom();document.addEventListener("keydown",(e=>{switch(e.key){case"ArrowUp":P=17;break;case"ArrowDown":P=14;break;case"ArrowLeft":I=-Math.PI/500;break;case"ArrowRight":I=Math.PI/500}})),document.addEventListener("keyup",(e=>{switch(e.key){case"ArrowUp":case"ArrowDown":P=l.default.getView().getZoom();break;default:I=0}}));const O=new w({particule:v,density:.5,angle:Math.PI/3,speed:1});l.default.addOverlay(O),window.cloud=O;const S=p.default.create("DIV",{className:"bar",parent:document.body});p.default.create("DIV",{className:"left",on:{pointerdown:()=>{I=-Math.PI/500}},parent:S}),p.default.create("DIV",{className:"up",on:{pointerdown:()=>{P=17}},parent:S}),p.default.create("DIV",{className:"down",on:{pointerdown:()=>{P=14}},parent:S}),p.default.create("DIV",{className:"right",on:{pointerdown:()=>{I=Math.PI/500}},parent:S}),document.addEventListener("pointerup",(()=>{P=l.default.getView().getZoom(),I=0})),p.default.create("BUTTON",{text:"Clouds",click:()=>{O.setVisible(!O.getVisible())},parent:S});