function t(t,e,i,s){Object.defineProperty(t,e,{get:i,set:s,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},a=e.parcelRequirecc54;null==a&&((a=function(t){if(t in i)return i[t].exports;if(t in s){var e=s[t];delete s[t];var a={id:t,exports:{}};return i[t]=a,e.call(a.exports,a,a.exports),a.exports}var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){s[t]=e},e.parcelRequirecc54=a),a.register("apY9r",(function(e,i){t(e.exports,"default",(()=>l));var s=a("fnScq"),n=a("gbCDL"),h=a("4QhZh"),r=a("ejLRd"),o=a("av6MI"),l=class extends s.default{constructor(t){t=t||{},super();var e=t.map||new(0,n.default)({target:t.target,loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,view:new(0,h.default)({zoom:t.zoom,center:t.center}),interactions:[],controls:[],layers:t.layers});if(t.controls)for(var i=0;i<t.controls.length;i++)e.addControl(t.controls[i]);this.setMap(e),this.pause_=!0,this.collisions=[],this.collision=new(0,o.default)({game:this,resample:t.collisionResample})}setMap(t){this._listener&&r.default.unByKey(this._listener),this._listener=null,this.map=t,this.map&&(this._listener=this.map.on("postcompose",this.anim_.bind(this)))}getMap(){return this.map}getView(){return this.map.getView()}addControl(t){return this.map.addControl(t)}collide(t,e){return this.collision.collide(t,e)}start(){this.time=(new Date).getTime(),this.pause_=!1,this.map.render(),this.dispatchEvent({type:"start"})}pause(){this.pause_=!0,this.dispatchEvent({type:"pause"})}paused(){return this.pause_}addCollision(t){t instanceof Array||(t=[t]),this.collisions=this.collisions.concat(t)}anim_(t){if(t.dt=t.frameState.time-this.time,this.time=t.frameState.time,this.frameState=t.frameState,!this.pause_){for(var e=this.collisions.length-1;e>=0;e--)this.collisions[e].dispatch();this.dispatchEvent({type:"render",context:t.context,dt:t.dt,frameState:t.frameState,vectorContext:t.vectorContext}),this.map.render()}}timer(t){this._time&&!0!==t?console.log("[TIMER] "+(new Date-this._time)+" : "+(t||"timer")):console.log("[TIMER] start"),this._time=new Date}}})),a.register("av6MI",(function(e,i){t(e.exports,"default",(()=>h));var s=a("fnScq"),n=a("jZquI"),h=class extends s.default{constructor(t){super(),this.game=t.game,this.resample=t.resample||1,this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=32,this.sprites=t.sprites||[],this.targets=t.targets||[]}getImage(){return this.canvas}overflow(t){if(!this.game.frameState)return!1;var e=this.game.frameState.extent,i=t.getBBox(this.game.frameState.viewState.resolution);return e[0]>i[0]?"E":e[1]>i[1]?"N":e[2]<i[2]?"W":e[3]<i[3]&&"S"}getPixel(t){var e=this.game.frameState.coordinateToPixelTransform;return[e[0]*t[0]+e[1]*t[1]+e[4],e[2]*t[0]+e[3]*t[1]+e[5]]}dispatch(){if(this.game.frameState)for(var t=this.sprites.length,e=0;e<t-1;e++)for(var i=e+1;i<t;i++){var s=this.collide(this.sprites[e],this.sprites[i]);s&&(this.sprites[e].dispatchEvent({type:"collide",sprite:this.sprites[i],hit:s}),this.sprites[i].dispatchEvent({type:"collide",sprite:this.sprites[e],hit:s}))}}collide(t,e){if(!this.game.frameState)return!1;var i=t.getBBox(this.game.frameState.viewState.resolution),s=e.getBBox(this.game.frameState.viewState.resolution);if(!(0,n.intersects)(i,s))return!1;var a=this.getPixel(i),h=this.getPixel(s),r=this.resample,o=Math.trunc(t.getImage().size*t.getImage().getScale()/r),l=this.canvas;l.width=l.height=o;var g=l.getContext("2d");g.save(),g.globalCompositeOperation="copy",g.fillStyle="#FFF",g.fillRect(0,0,o,o),g.globalCompositeOperation="destination-out",g.drawImage(t.getImage().getImage(),0,0,t.getImage().size,t.getImage().size,0,0,o,o),g.globalCompositeOperation="source-out",g.translate((h[0]-a[0])/r,(h[1]-a[1])/r),g.drawImage(e.getImage().getImage(),0,0,e.getImage().size,e.getImage().size,0,0,o,o),g.restore();for(var d=g.getImageData(0,0,o,o),c=3;c<d.data.length;c+=4)if(d.data[c]>0){var p=c/4/o|0;return[(c/4-p*o|0)*r,p*r]}}}})),a.register("gYm1x",(function(e,i){t(e.exports,"default",(()=>c));var s=a("iGyOD"),n=a("j2K3b"),h=a("l9IGS"),r=a("d5AAH"),o=a("2zf1Y"),l=a("kuKBR"),g=a("23ytq"),d=a("fXJsg");Math.sign||(Math.sign=function(t){return(t=Number(t))?t>0?1:-1:t}),Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)});var c=class extends s.default{constructor(t){t=t||{};var e=new(0,n.default)(t.position||[0,0]);super(e),this.coord=e,this.style=new(0,h.default)({image:new(0,d.default)(t),text:new(0,l.default)({font:"bold 12px helvetica,sans-serif",text:t.name||"",offsetY:-(t.size||64)/2*t.scale,textBaseline:"alphabetic",stroke:new(0,r.default)({color:[255,255,255,.5],width:5}),fill:new(0,o.default)({color:"#333"})})}),this.setStyle([this.style]),this.image=this.style.getImage(),this.frate=t.frameRate||100,this.currentState="idle",this.startState=0,this.speed=0,this.dir=[0,0]}setName(t){this.style.getText().setText(t),this.changed()}setCoordinate(t){this.coord.setCoordinates(t)}getCoordinate(){return this.coord.getCoordinates()}setGeometry(t){this.coord=t,s.default.prototype.setGeometry.call(this,t)}getImage(){return this.image}setRotation(t){this.style.getImage().setRotation(t),this.changed()}getRotation(){return this.style.getImage().getRotation()}setScale(t){this.style.getImage().setScale(t),this.changed()}getScale(){return this.style.getImage().getScale()}getBBox(t){var e=this.getCoordinate(),i=this.image.size*this.image.getScale()*t/2;return[e[0]-i,e[1]-i,e[0]+i,e[1]+i]}setState(t,e){return this.currentState=t,this.startState=e||(new Date).getTime(),this.dispatchEvent({type:"state",state:this.currentState,end:!1}),this.endState=!1,this.image.setState(this.currentState,0)}update(t){var e=this.image.setState(this.currentState,(t.frameState.time-this.startState)/this.frate);return e&&!this.endState&&(this.dispatchEvent({type:"state",state:this.currentState,end:!0}),this.endState=!0),e}setPath(t,e){null!=e&&(this.speed=e),t&&t.length&&(this.path=t,this.destination=1,this.moving_=!0,this.angle=Math.atan2(this.path[1][0]-this.path[0][0],this.path[1][1]-this.path[0][1]),this.dir=[Math.sin(this.angle),Math.cos(this.angle)],this.setCoordinate(this.path[0]),this.dispatchEvent({type:"change:direction",angle:this.angle}))}setDestination(t,e){this.setPath([this.getCoordinate(),t],e)}setDirection(t,e){this.destination=!1,this.moving_=!0,null!=e&&(this.speed=e),this.angle=t,this.dir=[Math.sin(this.angle),Math.cos(this.angle)],this.dispatchEvent({type:"change:direction",angle:this.angle})}getQuarter(){switch((Math.round(2*this.angle/Math.PI)+4)%4){case 0:return"N";case 1:return"E";case 2:return"S";case 3:return"W"}}moving(){return this.moving_}stop(){this.moving_=!1}restart(){this.moving_=!0}move(t){if(this.moving_){var e=this.getCoordinate(),i=[this.speed*this.dir[0]*t.dt,this.speed*this.dir[1]*t.dt];if(e[0]+=i[0],e[1]+=i[1],this.destination){var s=this.path[this.destination][0]-e[0],a=this.path[this.destination][1]-e[1];if(s&&Math.sign(s)!=Math.sign(this.dir[0])||a&&Math.sign(a)!=Math.sign(this.dir[1]))if(this.destination++,this.destination>=this.path.length)this.stop(),this.setCoordinate(this.path[this.destination-1]),this.destination=0,this.dispatchEvent({type:"destination"});else{for(var n=(0,g.ol_coordinate_dist2d)(e,this.path[this.destination-1]);;){var h=(0,g.ol_coordinate_dist2d)(this.path[this.destination],this.path[this.destination-1]);if(h>n)break;if(n-=h,this.destination++,this.destination>=this.path.length)return this.stop(),this.setCoordinate(this.path[this.destination-1]),this.destination=0,void this.dispatchEvent({type:"destination"})}this.setCoordinate(this.path[this.destination-1]),this.angle=Math.atan2(this.path[this.destination][0]-this.path[this.destination-1][0],this.path[this.destination][1]-this.path[this.destination-1][1]),this.dir=[Math.sin(this.angle),Math.cos(this.angle)],this.dispatchEvent({type:"change:direction",angle:this.angle}),this.move({type:t.type,dt:n/this.speed,frameState:t.frameState})}else this.setCoordinate(e)}else this.setCoordinate(e)}this.update(t)}setSpeed(t){this.speed=t}getSpeed(){return this.speed}}})),a.register("fXJsg",(function(e,i){t(e.exports,"default",(()=>h));var s=a("ayeEa"),n=class extends s.default{constructor(t){t=t||{};var e=document.createElement("canvas"),i=e.width=e.height=t.size||64;super({img:e,imgSize:[i,i],scale:t.scale}),this.size=i,this.offset=[0,0];var s,a=this;t.img?s=this.img_=t.img:((s=this.img_=new Image).crossOrigin=t.crossOrigin||"anonymous",s.src=t.src),t.states&&(this.states=t.states),s.width?this.drawImage_():s.onload=function(){a.drawImage_()}}drawImage_(){var t=this.getImage().getContext("2d");t.clearRect(0,0,this.size,this.size),t.drawImage(this.img_,this.offset[0],this.offset[1],this.size,this.size,0,0,this.size,this.size)}setState(t,e){var i=this.states[t]||{},s=[((i.start||0)+Math.trunc(e)%i.length)*(i.size||this.size),(i.line||0)*(i.size||this.size)];return s[0]==this.offset[0]&&s[1]==this.offset[1]||(this.offset=s,this.drawImage_()),e+1>=i.length}setAnchor(t){var e=this.getAnchor();e[0]=t[0]*this.size,e[1]=t[1]*this.size}};n.prototype.states={idle:{line:2,length:1},encant_N:{line:0,length:7},encant_W:{line:1,length:7},encant_S:{line:2,length:7},encant_E:{line:3,length:7},thrust_N:{line:4,length:8},thrust_W:{line:5,length:8},thrust_S:{line:6,length:8},thrust_E:{line:7,length:8},walk_N:{line:8,start:1,length:8},walk_W:{line:9,start:1,length:8},walk_S:{line:10,start:1,length:8},walk_E:{line:11,start:1,length:8},slash_N:{line:12,length:6},slash_W:{line:13,length:6},slash_S:{line:14,length:6},slash_E:{line:15,length:6},shoot_N:{line:16,length:13},shoot_W:{line:17,length:13},shoot_S:{line:18,length:13},shoot_E:{line:19,length:13},hurt:{line:20,length:6}};var h=n}));