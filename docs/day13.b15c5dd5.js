function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},i={},n=t.parcelRequirecc54;null==n&&((n=function(e){if(e in r)return r[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){i[e]=t},t.parcelRequirecc54=n);var s=n("6gELa");n("gvREW");var a=n("1B70O"),o=n("jZUWm");var l=n("945U7"),h=n("ejLRd"),u=n("ao9pQ"),c=n("l9IGS"),f=n("lqNjm"),d=n("6sFdl"),p=n("iQyfo"),g=class extends u.default{constructor(e){super(e=e||{}),this.element.classList.add("ol-canvas-control"),this.setCanvas(!!e.canvas),e||(e={}),e.style||(e.style=new(0,c.default)),this.setStyle(e.style)}setCanvas(e){if(this.isCanvas_=e,e&&this.setCollapsed(!1),this.element.style.visibility=e?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch(e){}}setStyle(e){var t=e.getText();this.font_=t?t.getFont():"10px sans-serif";var r=t?t.getStroke():null,i=t?t.getFill():null;this.fontStrokeStyle_=r?(0,f.asString)(r.getColor()):"#fff",this.fontFillStyle_=i?(0,f.asString)(i.getColor()):"#000",this.fontStrokeWidth_=r?r.getWidth():3,this.getMap()&&this.getMap().render()}setMap(e){d.default.prototype.getCanvas.call(this,e);var t=this.getMap();if(this._listener&&(0,h.unByKey)(this._listener),this._listener=null,super.setMap(e),t)try{t.renderSync()}catch(e){}e&&(this._listener=e.on("postcompose",this.drawAttribution_.bind(this))),this.setCanvas(this.isCanvas_)}drawAttribution_(e){if(this.isCanvas_){var t=this.getContext(e);if(t){var r="";Array.prototype.slice.call(this.element.querySelectorAll("li")).filter((function(e){return"none"!==e.style.display})).map((function(e){r+=(r?" - ":"")+e.textContent}));var i=e.frameState.pixelRatio;t.save(),t.scale(i,i);var n=this.element.getBoundingClientRect(),s=this.getMap().getViewport().getBoundingClientRect(),a=this.getMap().getSize()[0]/s.width;t.translate((n.left-s.left)*a,(n.top-s.top)*a);var o,l=this.element.clientHeight,h=this.element.clientWidth,u=p.default.getStyle(this.element,"textAlign")||"center";switch(u){case"left":o=0;break;case"right":o=h;break;default:o=h/2}t.beginPath(),t.strokeStyle=this.fontStrokeStyle_,t.fillStyle=this.fontFillStyle_,t.lineWidth=this.fontStrokeWidth_,t.textAlign=u,t.textBaseline="middle",t.font=this.font_,t.strokeText(r,o,l/2),t.fillText(r,o,l/2),t.closePath(),t.restore()}}}getContext(e){return d.default.prototype.getContext.call(this,e)}},m=(h=n("ejLRd"),n("4DafG")),y=n("eEuqc"),v=n("610XN"),_=n("gNqjI"),x=n("dMe05"),b=n("2YyN3"),E=(b=n("2YyN3"),n("gKdkP")),w=n("bCUH1"),T=n("lW8xZ");const L=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function S(e,t){t=Object.assign({preserveDrawingBuffer:!0,antialias:!T.SAFARI_BUG_237906},t);const r=L.length;for(let i=0;i<r;++i)try{const r=e.getContext(L[i],t);if(r)return r}catch(e){}return null}var I=n("eJ4LZ");const A={STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048};function R(e){switch(e){case 34962:default:return Float32Array;case 34963:return Uint32Array}}var C=class{constructor(e,t){this.array=null,this.type=e,(0,I.assert)(34962===e||34963===e,62),this.usage=void 0!==t?t:A.STATIC_DRAW}ofSize(e){this.array=new(R(this.type))(e)}fromArray(e){this.array=R(this.type).from(e)}fromArrayBuffer(e){this.array=new(R(this.type))(e)}getType(){return this.type}getArray(){return this.array}getUsage(){return this.usage}getSize(){return this.array?this.array.length:0}},B=n("7xQTT"),M=n("lgqLq"),P=n("fj1q7"),N=n("6ej6F"),F={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},U=n("jjfV9"),O=n("lVQul");var D=class{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();const r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),t.compileShader(r);const i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n"),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(r){this.uniforms_.push({value:e.uniforms[r],location:t.getUniformLocation(this.renderTargetProgram_,r)})}.bind(this))}getGL(){return this.gl_}init(e){const t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const e=0,i=t.RGBA,n=0,s=t.RGBA,a=t.UNSIGNED_BYTE,o=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,e,i,r[0],r[1],n,s,a,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}}apply(e,t,r,i){const n=this.getGL(),s=e.size;if(n.bindFramebuffer(n.FRAMEBUFFER,t?t.getFrameBuffer():null),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),!t){const t=(0,O.getUid)(n.canvas);if(!e.renderTargets[t]){const r=n.getContextAttributes();r&&r.preserveDrawingBuffer&&(n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT)),e.renderTargets[t]=!0}}n.enable(n.BLEND),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.useProgram(this.renderTargetProgram_),n.enableVertexAttribArray(this.renderTargetAttribLocation_),n.vertexAttribPointer(this.renderTargetAttribLocation_,2,n.FLOAT,!1,0,0),n.uniform2f(this.renderTargetUniformLocation_,s[0],s[1]),n.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;n.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),r&&r(n,e),n.drawArrays(n.TRIANGLES,0,6),i&&i(n,e)}getFrameBuffer(){return this.frameBuffer_}applyUniforms(e){const t=this.getGL();let r,i=1;this.uniforms_.forEach((function(n){if(r="function"==typeof n.value?n.value(e):n.value,r instanceof HTMLCanvasElement||r instanceof ImageData)n.texture||(n.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,n.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(n.location,i++);else if(Array.isArray(r))switch(r.length){case 2:return void t.uniform2f(n.location,r[0],r[1]);case 3:return void t.uniform3f(n.location,r[0],r[1],r[2]);case 4:return void t.uniform4f(n.location,r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&t.uniform1f(n.location,r)}))}},z=n("kKEgb"),k=n("14PDX");function G(e,t){return e[0]=t[0],e[1]=t[1],e[4]=t[2],e[5]=t[3],e[12]=t[4],e[13]=t[5],e}O=n("lVQul");const V={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",SIZE_PX:"u_sizePx",PIXEL_RATIO:"u_pixelRatio"},Z={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126},W={};function j(e){return"shared/"+e}let H=0;class X extends U.default{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?j(e.canvasCacheKey):function(){const e="unique/"+H;return H+=1,e}(),this.canvas_=function(e){let t=W[e];if(!t){const r=document.createElement("canvas");r.style.position="absolute",r.style.left="0",t={users:0,canvas:r},W[e]=t}return t.users+=1,t.canvas}(this.canvasCacheKey_),this.gl_=S(this.canvas_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.canvas_.addEventListener(F.LOST,this.boundHandleWebGLContextLost_),this.canvas_.addEventListener(F.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=(0,k.create)(),this.offsetScaleMatrix_=(0,k.create)(),this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.uniformLocations_={},this.attribLocations_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms);const t=this.getGL();this.postProcessPasses_=e.postProcesses?e.postProcesses.map((function(e){return new D({webGlContext:t,scaleRatio:e.scaleRatio,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms})})):[new D({webGlContext:t})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(e){this.uniforms_=[];for(const t in e)this.uniforms_.push({name:t,value:e[t]});this.uniformLocations_={}}canvasCacheKeyMatches(e){return this.canvasCacheKey_===j(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}bindBuffer(e){const t=this.getGL(),r=(0,O.getUid)(e);let i=this.bufferCache_[r];if(!i){i={buffer:e,webGlBuffer:t.createBuffer()},this.bufferCache_[r]=i}t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const t=this.getGL();this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=this.getGL(),r=(0,O.getUid)(e),i=this.bufferCache_[r];i&&!t.isContextLost()&&t.deleteBuffer(i.webGlBuffer),delete this.bufferCache_[r]}disposeInternal(){this.canvas_.removeEventListener(F.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(F.RESTORED,this.boundHandleWebGLContextRestored_),function(e){const t=W[e];if(!t)return;if(t.users-=1,t.users>0)return;const r=S(t.canvas).getExtension("WEBGL_lose_context");r&&r.loseContext(),delete W[e]}(this.canvasCacheKey_),delete this.gl_,delete this.canvas_}prepareDraw(e,t){const r=this.getGL(),i=this.getCanvas(),n=e.size,s=e.pixelRatio;i.width=n[0]*s,i.height=n[1]*s,i.style.width=n[0]+"px",i.style.height=n[1]+"px";for(let t=this.postProcessPasses_.length-1;t>=0;t--)this.postProcessPasses_[t].init(e);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,t?r.ZERO:r.ONE_MINUS_SRC_ALPHA)}prepareDrawToRenderTarget(e,t,r){const i=this.getGL(),n=t.getSize();i.bindFramebuffer(i.FRAMEBUFFER,t.getFramebuffer()),i.viewport(0,0,n[0],n[1]),i.bindTexture(i.TEXTURE_2D,t.getTexture()),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,r?i.ZERO:i.ONE_MINUS_SRC_ALPHA)}drawElements(e,t){const r=this.getGL();this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,n=t-e,s=4*e;r.drawElements(r.TRIANGLES,n,i,s)}finalizeDraw(e,t,r){for(let i=0,n=this.postProcessPasses_.length;i<n;i++)i===n-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.canvas_}getGL(){return this.gl_}applyFrameState(e){const t=e.size,r=e.viewState.rotation,i=e.pixelRatio,n=(0,k.reset)(this.offsetScaleMatrix_);(0,k.scale)(n,2/t[0],2/t[1]);const s=(0,k.reset)(this.offsetRotateMatrix_);0!==r&&(0,k.rotate)(s,-r),this.setUniformMatrixValue(V.OFFSET_SCALE_MATRIX,G(this.tmpMat4_,n)),this.setUniformMatrixValue(V.OFFSET_ROTATION_MATRIX,G(this.tmpMat4_,s)),this.setUniformFloatValue(V.TIME,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(V.ZOOM,e.viewState.zoom),this.setUniformFloatValue(V.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(V.PIXEL_RATIO,i),this.setUniformFloatVec2(V.SIZE_PX,[t[0],t[1]])}applyUniforms(e){const t=this.getGL();let r,i=0;this.uniforms_.forEach(function(n){if(r="function"==typeof n.value?n.value(e):n.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData){n.texture||(n.prevValue=void 0,n.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,n.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);(!(r instanceof HTMLImageElement)||r.complete)&&n.prevValue!==r&&(n.prevValue=r,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),t.uniform1i(this.getUniformLocation(n.name),i++)}else if(Array.isArray(r)&&6===r.length)this.setUniformMatrixValue(n.name,G(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:return void t.uniform2f(this.getUniformLocation(n.name),r[0],r[1]);case 3:return void t.uniform3f(this.getUniformLocation(n.name),r[0],r[1],r[2]);case 4:return void t.uniform4f(this.getUniformLocation(n.name),r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&t.uniform1f(this.getUniformLocation(n.name),r)}.bind(this))}useProgram(e,t){this.getGL().useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},this.applyFrameState(t),this.applyUniforms(t)}compileShader(e,t){const r=this.getGL(),i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){const r=this.getGL(),i=this.compileShader(e,r.FRAGMENT_SHADER),n=this.compileShader(t,r.VERTEX_SHADER),s=r.createProgram();if(r.attachShader(s,i),r.attachShader(s,n),r.linkProgram(s),!r.getShaderParameter(i,r.COMPILE_STATUS)){const e=`Fragment shader compliation failed: ${r.getShaderInfoLog(i)}`;throw new Error(e)}if(r.deleteShader(i),!r.getShaderParameter(n,r.COMPILE_STATUS)){const e=`Vertex shader compilation failed: ${r.getShaderInfoLog(n)}`;throw new Error(e)}if(r.deleteShader(n),!r.getProgramParameter(s,r.LINK_STATUS)){const e=`GL program linking failed: ${r.getShaderInfoLog(n)}`;throw new Error(e)}return s}getUniformLocation(e){return void 0===this.uniformLocations_[e]&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]}getAttributeLocation(e){return void 0===this.attribLocations_[e]&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]}makeProjectionTransform(e,t){const r=e.size,i=e.viewState.rotation,n=e.viewState.resolution,s=e.viewState.center;return(0,k.reset)(t),(0,k.compose)(t,0,0,2/(n*r[0]),2/(n*r[1]),-i,-s[0],-s[1]),t}setUniformFloatValue(e,t){this.getGL().uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.getGL().uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.getGL().uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(e),!1,t)}enableAttributeArray_(e,t,r,i,n){const s=this.getAttributeLocation(e);s<0||(this.getGL().enableVertexAttribArray(s),this.getGL().vertexAttribPointer(s,t,r,!1,i,n))}enableAttributes(e){const t=function(e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];t+=i.size*q(i.type)}return t}(e);let r=0;for(let i=0;i<e.length;i++){const n=e[i];this.enableAttributeArray_(n.name,n.size,n.type||5126,t,r),r+=n.size*q(n.type)}}handleWebGLContextLost(){(0,z.clear)(this.bufferCache_),this.currentProgram_=null}handleWebGLContextRestored(){}createTexture(e,t,r){const i=this.getGL();r=r||i.createTexture();const n=i.RGBA,s=i.RGBA,a=i.UNSIGNED_BYTE;return i.bindTexture(i.TEXTURE_2D,r),t?i.texImage2D(i.TEXTURE_2D,0,n,s,a,t):i.texImage2D(i.TEXTURE_2D,0,n,e[0],e[1],0,s,a,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),r}}function q(e){switch(e){case Z.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Z.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Z.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;default:return Float32Array.BYTES_PER_ELEMENT}}var Y=X;k=n("14PDX");class $ extends M.default{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=(0,k.create)(),this.pixelContext_=null,this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,e.addChangeListener(B.default.MAP,this.removeHelper.bind(this)),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(N.default.PRECOMPOSE)){const i=new(0,P.default)(N.default.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(N.default.POSTCOMPOSE)){const i=new(0,P.default)(N.default.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t,r=!0,i=-1;for(let n=0,s=e.layerStatesArray.length;n<s;n++){const s=e.layerStatesArray[n].layer,a=s.getRenderer();if(!(a instanceof $)){r=!0;continue}const o=s.getClassName();if((r||o!==t)&&(i+=1,r=!1),t=o,a===this)break}const n="map/"+e.mapId+"/group/"+i;this.helper&&this.helper.canvasCacheKeyMatches(n)||(this.removeHelper(),this.helper=new Y({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:n}),t&&(this.helper.getCanvas().className=t),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}disposeInternal(){this.removeHelper(),super.disposeInternal()}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){(0,k.compose)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const n=new(0,P.default)(e,this.inversePixelTransform_,r,t);i.dispatchEvent(n)}}preRender(e,t){this.dispatchRenderEvent_(N.default.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(N.default.POSTRENDER,e,t)}}var K=$,Q=n("kBSVF");const J=new Uint8Array(4);var ee=class{constructor(e,t){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){(0,Q.equals)(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return J[0]=0,J[1]=0,J[2]=0,J[3]=0,J;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return J[0]=this.data_[4*r],J[1]=this.data_[4*r+1],J[2]=this.data_[4*r+2],J[3]=this.data_[4*r+3],J}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(e[0]*e[1]*4)}};const te={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};k=n("14PDX"),I=n("eJ4LZ");var re=n("jZquI");function ie(e,t,r){r=r||2;var i,n,s,a,o,l,h,u=t&&t.length,c=u?t[0]*r:e.length,f=ne(e,0,c,r,!0),d=[];if(!f||f.next===f.prev)return d;if(u&&(f=function(e,t,r,i){var n,s,a,o=[];for(n=0,s=t.length;n<s;n++)(a=ne(e,t[n]*i,n<s-1?t[n+1]*i:e.length,i,!1))===a.next&&(a.steiner=!0),o.push(ge(a));for(o.sort(ce),n=0;n<o.length;n++)r=fe(o[n],r);return r}(e,t,f,r)),e.length>80*r){i=s=e[0],n=a=e[1];for(var p=r;p<c;p+=r)(o=e[p])<i&&(i=o),(l=e[p+1])<n&&(n=l),o>s&&(s=o),l>a&&(a=l);h=0!==(h=Math.max(s-i,a-n))?32767/h:0}return ae(f,d,r,i,n,h,0),d}function ne(e,t,r,i,n){var s,a;if(n===Ae(e,t,r,i)>0)for(s=t;s<r;s+=i)a=Le(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=Le(s,e[s],e[s+1],a);return a&&_e(a,a.next)&&(Se(a),a=a.next),a}function se(e,t){if(!e)return e;t||(t=e);var r,i=e;do{if(r=!1,i.steiner||!_e(i,i.next)&&0!==ve(i.prev,i,i.next))i=i.next;else{if(Se(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function ae(e,t,r,i,n,s,a){if(e){!a&&s&&function(e,t,r,i){var n=e;do{0===n.z&&(n.z=pe(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,i,n,s,a,o,l,h=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,o=0,t=0;t<h&&(o++,i=i.nextZ);t++);for(l=h;o>0||l>0&&i;)0!==o&&(0===l||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,h*=2}while(a>1)}(n)}(e,i,n,s);for(var o,l,h=e;e.prev!==e.next;)if(o=e.prev,l=e.next,s?le(e,i,n,s):oe(e))t.push(o.i/r|0),t.push(e.i/r|0),t.push(l.i/r|0),Se(e),e=l.next,h=l.next;else if((e=l)===h){a?1===a?ae(e=he(se(e),t,r),t,r,i,n,s,2):2===a&&ue(e,t,r,i,n,s):ae(se(e),t,r,i,n,s,1);break}}}function oe(e){var t=e.prev,r=e,i=e.next;if(ve(t,r,i)>=0)return!1;for(var n=t.x,s=r.x,a=i.x,o=t.y,l=r.y,h=i.y,u=n<s?n<a?n:a:s<a?s:a,c=o<l?o<h?o:h:l<h?l:h,f=n>s?n>a?n:a:s>a?s:a,d=o>l?o>h?o:h:l>h?l:h,p=i.next;p!==t;){if(p.x>=u&&p.x<=f&&p.y>=c&&p.y<=d&&me(n,o,s,l,a,h,p.x,p.y)&&ve(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function le(e,t,r,i){var n=e.prev,s=e,a=e.next;if(ve(n,s,a)>=0)return!1;for(var o=n.x,l=s.x,h=a.x,u=n.y,c=s.y,f=a.y,d=o<l?o<h?o:h:l<h?l:h,p=u<c?u<f?u:f:c<f?c:f,g=o>l?o>h?o:h:l>h?l:h,m=u>c?u>f?u:f:c>f?c:f,y=pe(d,p,t,r,i),v=pe(g,m,t,r,i),_=e.prevZ,x=e.nextZ;_&&_.z>=y&&x&&x.z<=v;){if(_.x>=d&&_.x<=g&&_.y>=p&&_.y<=m&&_!==n&&_!==a&&me(o,u,l,c,h,f,_.x,_.y)&&ve(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=d&&x.x<=g&&x.y>=p&&x.y<=m&&x!==n&&x!==a&&me(o,u,l,c,h,f,x.x,x.y)&&ve(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=y;){if(_.x>=d&&_.x<=g&&_.y>=p&&_.y<=m&&_!==n&&_!==a&&me(o,u,l,c,h,f,_.x,_.y)&&ve(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=v;){if(x.x>=d&&x.x<=g&&x.y>=p&&x.y<=m&&x!==n&&x!==a&&me(o,u,l,c,h,f,x.x,x.y)&&ve(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function he(e,t,r){var i=e;do{var n=i.prev,s=i.next.next;!_e(n,s)&&xe(n,i,i.next,s)&&we(n,s)&&we(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),Se(i),Se(i.next),i=e=s),i=i.next}while(i!==e);return se(i)}function ue(e,t,r,i,n,s){var a=e;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&ye(a,o)){var l=Te(a,o);return a=se(a,a.next),l=se(l,l.next),ae(a,t,r,i,n,s,0),void ae(l,t,r,i,n,s,0)}o=o.next}a=a.next}while(a!==e)}function ce(e,t){return e.x-t.x}function fe(e,t){var r=function(e,t){var r,i=t,n=e.x,s=e.y,a=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var o=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=n&&o>a&&(a=o,r=i.x<i.next.x?i:i.next,o===n))return r}i=i.next}while(i!==t);if(!r)return null;var l,h=r,u=r.x,c=r.y,f=1/0;i=r;do{n>=i.x&&i.x>=u&&n!==i.x&&me(s<c?n:a,s,u,c,s<c?a:n,s,i.x,i.y)&&(l=Math.abs(s-i.y)/(n-i.x),we(i,e)&&(l<f||l===f&&(i.x>r.x||i.x===r.x&&de(r,i)))&&(r=i,f=l)),i=i.next}while(i!==h);return r}(e,t);if(!r)return t;var i=Te(r,e);return se(i,i.next),se(r,r.next)}function de(e,t){return ve(e.prev,e,t.prev)<0&&ve(t.next,e,e.next)<0}function pe(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ge(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function me(e,t,r,i,n,s,a,o){return(n-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(r-a)*(t-o)&&(r-a)*(s-o)>=(n-a)*(i-o)}function ye(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&xe(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(we(e,t)&&we(t,e)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)&&(ve(e.prev,e,t.prev)||ve(e,t.prev,t))||_e(e,t)&&ve(e.prev,e,e.next)>0&&ve(t.prev,t,t.next)>0)}function ve(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function _e(e,t){return e.x===t.x&&e.y===t.y}function xe(e,t,r,i){var n=Ee(ve(e,t,r)),s=Ee(ve(e,t,i)),a=Ee(ve(r,i,e)),o=Ee(ve(r,i,t));return n!==s&&a!==o||(!(0!==n||!be(e,r,t))||(!(0!==s||!be(e,i,t))||(!(0!==a||!be(r,e,i))||!(0!==o||!be(r,t,i)))))}function be(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Ee(e){return e>0?1:e<0?-1:0}function we(e,t){return ve(e.prev,e,e.next)<0?ve(e,t,e.next)>=0&&ve(e,e.prev,t)>=0:ve(e,t,e.prev)<0||ve(e,e.next,t)<0}function Te(e,t){var r=new Ie(e.i,e.x,e.y),i=new Ie(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function Le(e,t,r,i){var n=new Ie(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Se(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ie(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ae(e,t,r,i){for(var n=0,s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}ie.default=ie,ie.deviation=function(e,t,r,i){var n=t&&t.length,s=n?t[0]*r:e.length,a=Math.abs(Ae(e,0,s,r));if(n)for(var o=0,l=t.length;o<l;o++){var h=t[o]*r,u=o<l-1?t[o+1]*r:e.length;a-=Math.abs(Ae(e,h,u,r))}var c=0;for(o=0;o<i.length;o+=3){var f=i[o]*r,d=i[o+1]*r,p=i[o+2]*r;c+=Math.abs((e[f]-e[p])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[p+1]-e[f+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},ie.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var s=0;s<e[n].length;s++)for(var a=0;a<t;a++)r.vertices.push(e[n][s][a]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r};k=n("14PDX");var Re=n("a6roo");function Ce(e,t){const r=256,i=255;return(t=t||[])[0]=Math.floor(e/r/r/r)/i,t[1]=Math.floor(e/r/r)%r/i,t[2]=Math.floor(e/r)%r/i,t[3]=e%r/i,t}function Be(e){let t=0;const r=256,i=255;return t+=Math.round(e[0]*r*r*r*i),t+=Math.round(e[1]*r*r*i),t+=Math.round(e[2]*r*i),t+=Math.round(e[3]*i),t}var Me,Pe,Ne;Pe=function(e){var t,r,i=Ge(e),n=i[0],s=i[1],a=new Oe(function(e,t,r){return 3*(t+r)/4-r}(0,n,s)),o=0,l=s>0?n-4:n;for(r=0;r<l;r+=4)t=Ue[e.charCodeAt(r)]<<18|Ue[e.charCodeAt(r+1)]<<12|Ue[e.charCodeAt(r+2)]<<6|Ue[e.charCodeAt(r+3)],a[o++]=t>>16&255,a[o++]=t>>8&255,a[o++]=255&t;2===s&&(t=Ue[e.charCodeAt(r)]<<2|Ue[e.charCodeAt(r+1)]>>4,a[o++]=255&t);1===s&&(t=Ue[e.charCodeAt(r)]<<10|Ue[e.charCodeAt(r+1)]<<4|Ue[e.charCodeAt(r+2)]>>2,a[o++]=t>>8&255,a[o++]=255&t);return a},Ne=function(e){for(var t,r=e.length,i=r%3,n=[],s=16383,a=0,o=r-i;a<o;a+=s)n.push(Ve(e,a,a+s>o?o:a+s));1===i?(t=e[r-1],n.push(Fe[t>>2]+Fe[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],n.push(Fe[t>>10]+Fe[t>>4&63]+Fe[t<<2&63]+"="));return n.join("")};for(var Fe=[],Ue=[],Oe="undefined"!=typeof Uint8Array?Uint8Array:Array,De="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ze=0,ke=De.length;ze<ke;++ze)Fe[ze]=De[ze],Ue[De.charCodeAt(ze)]=ze;function Ge(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function Ve(e,t,r){for(var i,n,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(Fe[(n=i)>>18&63]+Fe[n>>12&63]+Fe[n>>6&63]+Fe[63&n]);return s.join("")}Ue["-".charCodeAt(0)]=62,Ue["_".charCodeAt(0)]=63;var Ze=n("7y6mg");const We="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;Me=He;function je(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,He.prototype),t}function He(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return Ye(e)}return Xe(e,t,r)}function Xe(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!He.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|Je(e,t);let i=je(r);const n=i.write(e,t);n!==r&&(i=i.slice(0,n));return i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Mt(e,Uint8Array)){const t=new Uint8Array(e);return Ke(t.buffer,t.byteOffset,t.byteLength)}return $e(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Mt(e,ArrayBuffer)||e&&Mt(e.buffer,ArrayBuffer))return Ke(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(Mt(e,SharedArrayBuffer)||e&&Mt(e.buffer,SharedArrayBuffer)))return Ke(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return He.from(i,t,r);const n=function(e){if(He.isBuffer(e)){const t=0|Qe(e.length),r=je(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||Pt(e.length)?je(0):$e(e);if("Buffer"===e.type&&Array.isArray(e.data))return $e(e.data)}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return He.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function qe(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function Ye(e){return qe(e),je(e<0?0:0|Qe(e))}function $e(e){const t=e.length<0?0:0|Qe(e.length),r=je(t);for(let i=0;i<t;i+=1)r[i]=255&e[i];return r}function Ke(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(i,He.prototype),i}function Qe(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function Je(e,t){if(He.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Mt(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;let n=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Rt(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Ct(e).length;default:if(n)return i?-1:Rt(e).length;t=(""+t).toLowerCase(),n=!0}}function et(e,t,r){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return dt(this,t,r);case"utf8":case"utf-8":return ut(this,t,r);case"ascii":return ct(this,t,r);case"latin1":case"binary":return ft(this,t,r);case"base64":return ht(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pt(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function tt(e,t,r){const i=e[t];e[t]=e[r],e[r]=i}function rt(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Pt(r=+r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=He.from(t,i)),He.isBuffer(t))return 0===t.length?-1:it(e,t,r,i,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):it(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function it(e,t,r,i,n){let s,a=1,o=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,o/=2,l/=2,r/=2}function h(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(n){let i=-1;for(s=r;s<o;s++)if(h(e,s)===h(t,-1===i?0:s-i)){if(-1===i&&(i=s),s-i+1===l)return i*a}else-1!==i&&(s-=s-i),i=-1}else for(r+l>o&&(r=o-l),s=r;s>=0;s--){let r=!0;for(let i=0;i<l;i++)if(h(e,s+i)!==h(t,i)){r=!1;break}if(r)return s}return-1}function nt(e,t,r,i){r=Number(r)||0;const n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;const s=t.length;let a;for(i>s/2&&(i=s/2),a=0;a<i;++a){const i=parseInt(t.substr(2*a,2),16);if(Pt(i))return a;e[r+a]=i}return a}function st(e,t,r,i){return Bt(Rt(t,e.length-r),e,r,i)}function at(e,t,r,i){return Bt(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function ot(e,t,r,i){return Bt(Ct(t),e,r,i)}function lt(e,t,r,i){return Bt(function(e,t){let r,i,n;const s=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),i=r>>8,n=r%256,s.push(n),s.push(i);return s}(t,e.length-r),e,r,i)}function ht(e,t,r){return 0===t&&r===e.length?Ne(e):Ne(e.slice(t,r))}function ut(e,t,r){r=Math.min(e.length,r);const i=[];let n=t;for(;n<r;){const t=e[n];let s=null,a=t>239?4:t>223?3:t>191?2:1;if(n+a<=r){let r,i,o,l;switch(a){case 1:t<128&&(s=t);break;case 2:r=e[n+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(s=l));break;case 3:r=e[n+1],i=e[n+2],128==(192&r)&&128==(192&i)&&(l=(15&t)<<12|(63&r)<<6|63&i,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:r=e[n+1],i=e[n+2],o=e[n+3],128==(192&r)&&128==(192&i)&&128==(192&o)&&(l=(15&t)<<18|(63&r)<<12|(63&i)<<6|63&o,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),n+=a}return function(e){const t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}(i)}He.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),He.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(He.prototype,"parent",{enumerable:!0,get:function(){if(He.isBuffer(this))return this.buffer}}),Object.defineProperty(He.prototype,"offset",{enumerable:!0,get:function(){if(He.isBuffer(this))return this.byteOffset}}),He.poolSize=8192,He.from=function(e,t,r){return Xe(e,t,r)},Object.setPrototypeOf(He.prototype,Uint8Array.prototype),Object.setPrototypeOf(He,Uint8Array),He.alloc=function(e,t,r){return function(e,t,r){return qe(e),e<=0?je(e):void 0!==t?"string"==typeof r?je(e).fill(t,r):je(e).fill(t):je(e)}(e,t,r)},He.allocUnsafe=function(e){return Ye(e)},He.allocUnsafeSlow=function(e){return Ye(e)},He.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==He.prototype},He.compare=function(e,t){if(Mt(e,Uint8Array)&&(e=He.from(e,e.offset,e.byteLength)),Mt(t,Uint8Array)&&(t=He.from(t,t.offset,t.byteLength)),!He.isBuffer(e)||!He.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,i=t.length;for(let n=0,s=Math.min(r,i);n<s;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},He.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},He.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return He.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const i=He.allocUnsafe(t);let n=0;for(r=0;r<e.length;++r){let t=e[r];if(Mt(t,Uint8Array))n+t.length>i.length?(He.isBuffer(t)||(t=He.from(t)),t.copy(i,n)):Uint8Array.prototype.set.call(i,t,n);else{if(!He.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(i,n)}n+=t.length}return i},He.byteLength=Je,He.prototype._isBuffer=!0,He.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)tt(this,t,t+1);return this},He.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)tt(this,t,t+3),tt(this,t+1,t+2);return this},He.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)tt(this,t,t+7),tt(this,t+1,t+6),tt(this,t+2,t+5),tt(this,t+3,t+4);return this},He.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?ut(this,0,e):et.apply(this,arguments)},He.prototype.toLocaleString=He.prototype.toString,He.prototype.equals=function(e){if(!He.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===He.compare(this,e)},He.prototype.inspect=function(){let e="";return e=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(e+=" ... "),"<Buffer "+e+">"},We&&(He.prototype[We]=He.prototype.inspect),He.prototype.compare=function(e,t,r,i,n){if(Mt(e,Uint8Array)&&(e=He.from(e,e.offset,e.byteLength)),!He.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(n>>>=0)-(i>>>=0),a=(r>>>=0)-(t>>>=0);const o=Math.min(s,a),l=this.slice(i,n),h=e.slice(t,r);for(let e=0;e<o;++e)if(l[e]!==h[e]){s=l[e],a=h[e];break}return s<a?-1:a<s?1:0},He.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},He.prototype.indexOf=function(e,t,r){return rt(this,e,t,r,!0)},He.prototype.lastIndexOf=function(e,t,r){return rt(this,e,t,r,!1)},He.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}const n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return nt(this,e,t,r);case"utf8":case"utf-8":return st(this,e,t,r);case"ascii":case"latin1":case"binary":return at(this,e,t,r);case"base64":return ot(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lt(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},He.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ct(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function ft(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function dt(e,t,r){const i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);let n="";for(let i=t;i<r;++i)n+=Nt[e[i]];return n}function pt(e,t,r){const i=e.slice(t,r);let n="";for(let e=0;e<i.length-1;e+=2)n+=String.fromCharCode(i[e]+256*i[e+1]);return n}function gt(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function mt(e,t,r,i,n,s){if(!He.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function yt(e,t,r,i,n){Lt(t,i,n,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function vt(e,t,r,i,n){Lt(t,i,n,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function _t(e,t,r,i,n,s){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function xt(e,t,r,i,n){return t=+t,r>>>=0,n||_t(e,0,r,4),Ze.write(e,t,r,i,23,4),r+4}function bt(e,t,r,i,n){return t=+t,r>>>=0,n||_t(e,0,r,8),Ze.write(e,t,r,i,52,8),r+8}He.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const i=this.subarray(e,t);return Object.setPrototypeOf(i,He.prototype),i},He.prototype.readUintLE=He.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||gt(e,t,this.length);let i=this[e],n=1,s=0;for(;++s<t&&(n*=256);)i+=this[e+s]*n;return i},He.prototype.readUintBE=He.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||gt(e,t,this.length);let i=this[e+--t],n=1;for(;t>0&&(n*=256);)i+=this[e+--t]*n;return i},He.prototype.readUint8=He.prototype.readUInt8=function(e,t){return e>>>=0,t||gt(e,1,this.length),this[e]},He.prototype.readUint16LE=He.prototype.readUInt16LE=function(e,t){return e>>>=0,t||gt(e,2,this.length),this[e]|this[e+1]<<8},He.prototype.readUint16BE=He.prototype.readUInt16BE=function(e,t){return e>>>=0,t||gt(e,2,this.length),this[e]<<8|this[e+1]},He.prototype.readUint32LE=He.prototype.readUInt32LE=function(e,t){return e>>>=0,t||gt(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},He.prototype.readUint32BE=He.prototype.readUInt32BE=function(e,t){return e>>>=0,t||gt(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},He.prototype.readBigUInt64LE=Ft((function(e){St(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||It(e,this.length-8);const i=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,n=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(i)+(BigInt(n)<<BigInt(32))})),He.prototype.readBigUInt64BE=Ft((function(e){St(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||It(e,this.length-8);const i=t*2**24+65536*this[++e]+256*this[++e]+this[++e],n=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(i)<<BigInt(32))+BigInt(n)})),He.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||gt(e,t,this.length);let i=this[e],n=1,s=0;for(;++s<t&&(n*=256);)i+=this[e+s]*n;return n*=128,i>=n&&(i-=Math.pow(2,8*t)),i},He.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||gt(e,t,this.length);let i=t,n=1,s=this[e+--i];for(;i>0&&(n*=256);)s+=this[e+--i]*n;return n*=128,s>=n&&(s-=Math.pow(2,8*t)),s},He.prototype.readInt8=function(e,t){return e>>>=0,t||gt(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},He.prototype.readInt16LE=function(e,t){e>>>=0,t||gt(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},He.prototype.readInt16BE=function(e,t){e>>>=0,t||gt(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},He.prototype.readInt32LE=function(e,t){return e>>>=0,t||gt(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},He.prototype.readInt32BE=function(e,t){return e>>>=0,t||gt(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},He.prototype.readBigInt64LE=Ft((function(e){St(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||It(e,this.length-8);const i=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),He.prototype.readBigInt64BE=Ft((function(e){St(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||It(e,this.length-8);const i=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),He.prototype.readFloatLE=function(e,t){return e>>>=0,t||gt(e,4,this.length),Ze.read(this,e,!0,23,4)},He.prototype.readFloatBE=function(e,t){return e>>>=0,t||gt(e,4,this.length),Ze.read(this,e,!1,23,4)},He.prototype.readDoubleLE=function(e,t){return e>>>=0,t||gt(e,8,this.length),Ze.read(this,e,!0,52,8)},He.prototype.readDoubleBE=function(e,t){return e>>>=0,t||gt(e,8,this.length),Ze.read(this,e,!1,52,8)},He.prototype.writeUintLE=He.prototype.writeUIntLE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){mt(this,e,t,r,Math.pow(2,8*r)-1,0)}let n=1,s=0;for(this[t]=255&e;++s<r&&(n*=256);)this[t+s]=e/n&255;return t+r},He.prototype.writeUintBE=He.prototype.writeUIntBE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){mt(this,e,t,r,Math.pow(2,8*r)-1,0)}let n=r-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+r},He.prototype.writeUint8=He.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,1,255,0),this[t]=255&e,t+1},He.prototype.writeUint16LE=He.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},He.prototype.writeUint16BE=He.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},He.prototype.writeUint32LE=He.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},He.prototype.writeUint32BE=He.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},He.prototype.writeBigUInt64LE=Ft((function(e,t=0){return yt(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),He.prototype.writeBigUInt64BE=Ft((function(e,t=0){return vt(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),He.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*r-1);mt(this,e,t,r,i-1,-i)}let n=0,s=1,a=0;for(this[t]=255&e;++n<r&&(s*=256);)e<0&&0===a&&0!==this[t+n-1]&&(a=1),this[t+n]=(e/s>>0)-a&255;return t+r},He.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*r-1);mt(this,e,t,r,i-1,-i)}let n=r-1,s=1,a=0;for(this[t+n]=255&e;--n>=0&&(s*=256);)e<0&&0===a&&0!==this[t+n+1]&&(a=1),this[t+n]=(e/s>>0)-a&255;return t+r},He.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},He.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},He.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},He.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},He.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||mt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},He.prototype.writeBigInt64LE=Ft((function(e,t=0){return yt(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),He.prototype.writeBigInt64BE=Ft((function(e,t=0){return vt(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),He.prototype.writeFloatLE=function(e,t,r){return xt(this,e,t,!0,r)},He.prototype.writeFloatBE=function(e,t,r){return xt(this,e,t,!1,r)},He.prototype.writeDoubleLE=function(e,t,r){return bt(this,e,t,!0,r)},He.prototype.writeDoubleBE=function(e,t,r){return bt(this,e,t,!1,r)},He.prototype.copy=function(e,t,r,i){if(!He.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);const n=i-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),n},He.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!He.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){const t=e.charCodeAt(0);("utf8"===i&&t<128||"latin1"===i)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let n;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{const s=He.isBuffer(e)?e:He.from(e,i),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=s[n%a]}return this};const Et={};function wt(e,t,r){Et[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function Tt(e){let t="",r=e.length;const i="-"===e[0]?1:0;for(;r>=i+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function Lt(e,t,r,i,n,s){if(e>r||e<t){const i="bigint"==typeof t?"n":"";let n;throw n=s>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(s+1)}${i}`:`>= -(2${i} ** ${8*(s+1)-1}${i}) and < 2 ** ${8*(s+1)-1}${i}`:`>= ${t}${i} and <= ${r}${i}`,new Et.ERR_OUT_OF_RANGE("value",n,e)}!function(e,t,r){St(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||It(t,e.length-(r+1))}(i,n,s)}function St(e,t){if("number"!=typeof e)throw new Et.ERR_INVALID_ARG_TYPE(t,"number",e)}function It(e,t,r){if(Math.floor(e)!==e)throw St(e,r),new Et.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new Et.ERR_BUFFER_OUT_OF_BOUNDS;throw new Et.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}wt("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),wt("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),wt("ERR_OUT_OF_RANGE",(function(e,t,r){let i=`The value of "${e}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=Tt(String(r)):"bigint"==typeof r&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=Tt(n)),n+="n"),i+=` It must be ${t}. Received ${n}`,i}),RangeError);const At=/[^+/0-9A-Za-z-_]/g;function Rt(e,t){let r;t=t||1/0;const i=e.length;let n=null;const s=[];for(let a=0;a<i;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function Ct(e){return Pe(function(e){if((e=(e=e.split("=")[0]).trim().replace(At,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Bt(e,t,r,i){let n;for(n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function Mt(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Pt(e){return e!=e}const Nt=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const i=16*r;for(let n=0;n<16;++n)t[i+n]=e[r]+e[n]}return t}();function Ft(e){return"undefined"==typeof BigInt?Ut:e}function Ut(){throw new Error("BigInt not supported")}var Ot=Me;function Dt(){const e='const e="GENERATE_POLYGON_BUFFERS",t="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS",r="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"";r.includes("firefox");r.includes("safari")&&!r.includes("chrom")&&(r.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(r)),r.includes("webkit")&&r.includes("edge"),r.includes("macintosh"),"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&(self,WorkerGlobalScope),function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch(e){}}();const o={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:\'`renderMode` must be `"hybrid"` or `"vector"`\',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection"};class i extends Error{constructor(e){const t=o[e];super(t),this.code=e,this.name="AssertionError",this.message=t}}function s(e,t){const n=t[0],r=t[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t}function a(e,t){const n=(r=t)[0]*r[3]-r[1]*r[2];var r;!function(e,t){if(!e)throw new i(t)}(0!==n,32);const o=t[0],s=t[1],a=t[2],u=t[3],x=t[4],f=t[5];return e[0]=u/n,e[1]=-s/n,e[2]=-a/n,e[3]=o/n,e[4]=(a*f-u*x)/n,e[5]=-(o*f-s*x)/n,e}new Array(6);var u={exports:{}};function x(e,t,n){n=n||2;var r,o,i,s,a,u,x,y=t&&t.length,d=y?t[0]*n:e.length,h=f(e,0,d,n,!0),v=[];if(!h||h.next===h.prev)return v;if(y&&(h=function(e,t,n,r){var o,i,s,a=[];for(o=0,i=t.length;o<i;o++)(s=f(e,t[o]*r,o<i-1?t[o+1]*r:e.length,r,!1))===s.next&&(s.steiner=!0),a.push(w(s));for(a.sort(p),o=0;o<a.length;o++)n=l(n=g(a[o],n),n.next);return n}(e,t,h,n)),e.length>80*n){r=i=e[0],o=s=e[1];for(var b=n;b<d;b+=n)(a=e[b])<r&&(r=a),(u=e[b+1])<o&&(o=u),a>i&&(i=a),u>s&&(s=u);x=0!==(x=Math.max(i-r,s-o))?1/x:0}return c(h,v,n,r,o,x),v}function f(e,t,n,r,o){var i,s;if(o===B(e,t,n,r)>0)for(i=t;i<n;i+=r)s=U(i,e[i],e[i+1],s);else for(i=n-r;i>=t;i-=r)s=U(i,e[i],e[i+1],s);return s&&M(s,s.next)&&(z(s),s=s.next),s}function l(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!M(r,r.next)&&0!==Z(r.prev,r,r.next))r=r.next;else{if(z(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function c(e,t,n,r,o,i,s){if(e){!s&&i&&function(e,t,n,r){var o=e;do{null===o.z&&(o.z=m(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,n,r,o,i,s,a,u,x=1;do{for(n=e,e=null,i=null,s=0;n;){for(s++,r=n,a=0,t=0;t<x&&(a++,r=r.nextZ);t++);for(u=x;a>0||u>0&&r;)0!==a&&(0===u||!r||n.z<=r.z)?(o=n,n=n.nextZ,a--):(o=r,r=r.nextZ,u--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;n=r}i.nextZ=null,x*=2}while(s>1)}(o)}(e,r,o,i);for(var a,u,x=e;e.prev!==e.next;)if(a=e.prev,u=e.next,i?d(e,r,o,i):y(e))t.push(a.i/n),t.push(e.i/n),t.push(u.i/n),z(e),e=u.next,x=u.next;else if((e=u)===x){s?1===s?c(e=h(l(e),t,n),t,n,r,o,i,2):2===s&&v(e,t,n,r,o,i):c(l(e),t,n,r,o,i,1);break}}}function y(e){var t=e.prev,n=e,r=e.next;if(Z(t,n,r)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(A(t.x,t.y,n.x,n.y,r.x,r.y,o.x,o.y)&&Z(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function d(e,t,n,r){var o=e.prev,i=e,s=e.next;if(Z(o,i,s)>=0)return!1;for(var a=o.x<i.x?o.x<s.x?o.x:s.x:i.x<s.x?i.x:s.x,u=o.y<i.y?o.y<s.y?o.y:s.y:i.y<s.y?i.y:s.y,x=o.x>i.x?o.x>s.x?o.x:s.x:i.x>s.x?i.x:s.x,f=o.y>i.y?o.y>s.y?o.y:s.y:i.y>s.y?i.y:s.y,l=m(a,u,t,n,r),c=m(x,f,t,n,r),y=e.prevZ,d=e.nextZ;y&&y.z>=l&&d&&d.z<=c;){if(y!==e.prev&&y!==e.next&&A(o.x,o.y,i.x,i.y,s.x,s.y,y.x,y.y)&&Z(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,d!==e.prev&&d!==e.next&&A(o.x,o.y,i.x,i.y,s.x,s.y,d.x,d.y)&&Z(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;y&&y.z>=l;){if(y!==e.prev&&y!==e.next&&A(o.x,o.y,i.x,i.y,s.x,s.y,y.x,y.y)&&Z(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;d&&d.z<=c;){if(d!==e.prev&&d!==e.next&&A(o.x,o.y,i.x,i.y,s.x,s.y,d.x,d.y)&&Z(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function h(e,t,n){var r=e;do{var o=r.prev,i=r.next.next;!M(o,i)&&F(o,r,r.next,i)&&k(o,i)&&k(i,o)&&(t.push(o.i/n),t.push(r.i/n),t.push(i.i/n),z(r),z(r.next),r=e=i),r=r.next}while(r!==e);return l(r)}function v(e,t,n,r,o,i){var s=e;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&E(s,a)){var u=S(s,a);return s=l(s,s.next),u=l(u,u.next),c(s,t,n,r,o,i),void c(u,t,n,r,o,i)}a=a.next}s=s.next}while(s!==e)}function p(e,t){return e.x-t.x}function g(e,t){var n=function(e,t){var n,r=t,o=e.x,i=e.y,s=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=o&&a>s){if(s=a,a===o){if(i===r.y)return r;if(i===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(o===s)return n;var u,x=n,f=n.x,l=n.y,c=1/0;r=n;do{o>=r.x&&r.x>=f&&o!==r.x&&A(i<l?o:s,i,f,l,i<l?s:o,i,r.x,r.y)&&(u=Math.abs(i-r.y)/(o-r.x),k(r,e)&&(u<c||u===c&&(r.x>n.x||r.x===n.x&&b(n,r)))&&(n=r,c=u)),r=r.next}while(r!==x);return n}(e,t);if(!n)return t;var r=S(n,e),o=l(n,n.next);return l(r,r.next),t===n?o:t}function b(e,t){return Z(e.prev,e,t.prev)<0&&Z(t.next,e,e.next)<0}function m(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function w(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function A(e,t,n,r,o,i,s,a){return(o-s)*(t-a)-(e-s)*(i-a)>=0&&(e-s)*(r-a)-(n-s)*(t-a)>=0&&(n-s)*(i-a)-(o-s)*(r-a)>=0}function E(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&F(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(k(e,t)&&k(t,e)&&function(e,t){var n=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Z(e.prev,e,t.prev)||Z(e,t.prev,t))||M(e,t)&&Z(e.prev,e,e.next)>0&&Z(t.prev,t,t.next)>0)}function Z(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function M(e,t){return e.x===t.x&&e.y===t.y}function F(e,t,n,r){var o=I(Z(e,t,n)),i=I(Z(e,t,r)),s=I(Z(n,r,e)),a=I(Z(n,r,t));return o!==i&&s!==a||(!(0!==o||!T(e,n,t))||(!(0!==i||!T(e,r,t))||(!(0!==s||!T(n,e,r))||!(0!==a||!T(n,t,r)))))}function T(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function I(e){return e>0?1:e<0?-1:0}function k(e,t){return Z(e.prev,e,e.next)<0?Z(e,t,e.next)>=0&&Z(e,e.prev,t)>=0:Z(e,t,e.prev)<0||Z(e,e.next,t)<0}function S(e,t){var n=new R(e.i,e.x,e.y),r=new R(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function U(e,t,n,r){var o=new R(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function R(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function B(e,t,n,r){for(var o=0,i=t,s=n-r;i<n;i+=r)o+=(e[s]-e[i])*(e[i+1]+e[s+1]),s=i;return o}u.exports=x,u.exports.default=x,x.deviation=function(e,t,n,r){var o=t&&t.length,i=o?t[0]*n:e.length,s=Math.abs(B(e,0,i,n));if(o)for(var a=0,u=t.length;a<u;a++){var x=t[a]*n,f=a<u-1?t[a+1]*n:e.length;s-=Math.abs(B(e,x,f,n))}var l=0;for(a=0;a<r.length;a+=3){var c=r[a]*n,y=r[a+1]*n,d=r[a+2]*n;l+=Math.abs((e[c]-e[d])*(e[y+1]-e[c+1])-(e[c]-e[y])*(e[d+1]-e[c+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},x.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var s=0;s<t;s++)n.vertices.push(e[o][i][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};const P=[],C={vertexPosition:0,indexPosition:0};function N(e,t,n,r,o){e[t+0]=n,e[t+1]=r,e[t+2]=o}function _(e,t,n,r,o,i){const s=3+o,a=e[t+0],u=e[t+1],x=P;x.length=o;for(let n=0;n<x.length;n++)x[n]=e[t+2+n];let f=i?i.vertexPosition:0,l=i?i.indexPosition:0;const c=f/s;return N(n,f,a,u,0),x.length&&n.set(x,f+3),f+=s,N(n,f,a,u,1),x.length&&n.set(x,f+3),f+=s,N(n,f,a,u,2),x.length&&n.set(x,f+3),f+=s,N(n,f,a,u,3),x.length&&n.set(x,f+3),f+=s,r[l++]=c,r[l++]=c+1,r[l++]=c+3,r[l++]=c+1,r[l++]=c+2,r[l++]=c+3,C.vertexPosition=f,C.indexPosition=l,C}function L(e,t,n,r,o,i,a,u,x,f){const l=5+u.length,c=i.length/l,y=[e[t+0],e[t+1]],d=[e[n],e[n+1]],h=s(f,[...y]),v=s(f,[...d]);function p(e,t,n){const r=1e4;return Math.round(1500*t)+Math.round(1500*n)*r+e*r*r}function g(e,t,n){const r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),o=[(t[0]-e[0])/r,(t[1]-e[1])/r],i=[-o[1],o[0]],s=Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])),a=[(n[0]-e[0])/s,(n[1]-e[1])/s],u=0===r||0===s?0:Math.acos((x=a[0]*o[0]+a[1]*o[1],f=-1,l=1,Math.min(Math.max(x,f),l)));var x,f,l;return a[0]*i[0]+a[1]*i[1]>0?u:2*Math.PI-u}const b=null!==o;let m=0,w=0;if(null!==r){m=g(h,v,s(f,[...[e[r],e[r+1]]]))}if(b){w=g(v,h,s(f,[...[e[o],e[o+1]]]))}i.push(y[0],y[1],d[0],d[1],p(0,m,w)),i.push(...u),i.push(y[0],y[1],d[0],d[1],p(1,m,w)),i.push(...u),i.push(y[0],y[1],d[0],d[1],p(2,m,w)),i.push(...u),i.push(y[0],y[1],d[0],d[1],p(3,m,w)),i.push(...u),a.push(c,c+1,c+2,c+1,c+3,c+2)}function G(e,t,n,r,o){const i=2+o;let s=t;const a=e.slice(s,s+o);s+=o;const x=e[s++];let f=0;const l=new Array(x-1);for(let t=0;t<x;t++)f+=e[s++],t<x-1&&(l[t]=f);const c=e.slice(s,s+2*f),y=u.exports(c,l,2);for(let e=0;e<y.length;e++)r.push(y[e]+n.length/i);for(let e=0;e<c.length;e+=2)n.push(c[e],c[e+1],...a);return s+2*f}const O=self;O.onmessage=r=>{const o=r.data;switch(o.type){case t:{const e=3,t=2,n=o.customAttributesCount,r=t+n,i=new Float32Array(o.renderInstructions),s=i.length/r,a=4*s*(n+e),u=new Uint32Array(6*s),x=new Float32Array(a);let f;for(let e=0;e<i.length;e+=r)f=_(i,e,x,u,n,f);const l=Object.assign({vertexBuffer:x.buffer,indexBuffer:u.buffer,renderInstructions:i.buffer},o);O.postMessage(l,[x.buffer,u.buffer,i.buffer]);break}case n:{const e=[],t=[],n=o.customAttributesCount,r=2,i=new Float32Array(o.renderInstructions);let s=0;const u=o.renderInstructionsTransform,x=[1,0,0,1,0,0];let f,l;for(a(x,u);s<i.length;){l=Array.from(i.slice(s,s+n)),s+=n,f=i[s++];for(let n=0;n<f-1;n++)L(i,s+n*r,s+(n+1)*r,n>0?s+(n-1)*r:null,n<f-2?s+(n+2)*r:null,e,t,l,0,x);s+=f*r}const c=Uint32Array.from(t),y=Float32Array.from(e),d=Object.assign({vertexBuffer:y.buffer,indexBuffer:c.buffer,renderInstructions:i.buffer},o);O.postMessage(d,[y.buffer,c.buffer,i.buffer]);break}case e:{const e=[],t=[],n=o.customAttributesCount,r=new Float32Array(o.renderInstructions);let i=0;for(;i<r.length;)i=G(r,i,e,t,n);const s=Uint32Array.from(t),a=Float32Array.from(e),u=Object.assign({vertexBuffer:a.buffer,indexBuffer:s.buffer,renderInstructions:r.buffer},o);O.postMessage(u,[a.buffer,s.buffer,r.buffer]);break}}};';return new Worker("undefined"==typeof Blob?"data:application/javascript;base64,"+Ot.from(e,"binary").toString("base64"):URL.createObjectURL(new Blob([e],{type:"application/javascript"})))}O=n("lVQul");var zt=n("bsgMw");var kt=class extends K{constructor(e,t){const r=t.uniforms||{},i=(0,k.create)();r[V.PROJECTION_MATRIX]=i,super(e,{uniforms:r,postProcesses:t.postProcesses}),this.ready=!1,this.sourceRevision_=-1,this.verticesBuffer_=new C(34962,35048),this.hitVerticesBuffer_=new C(34962,35048),this.indicesBuffer_=new C(34963,35048),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.program_,this.hitDetectionEnabled_=!(!t.hitFragmentShader||!t.hitVertexShader),this.hitVertexShader_=t.hitVertexShader,this.hitFragmentShader_=t.hitFragmentShader,this.hitProgram_;const n=t.attributes?t.attributes.map((function(e){return{name:"a_"+e.name,size:1,type:Z.FLOAT}})):[];this.attributes=[{name:"a_position",size:2,type:Z.FLOAT},{name:"a_index",size:1,type:Z.FLOAT}].concat(n),this.hitDetectionAttributes=[{name:"a_position",size:2,type:Z.FLOAT},{name:"a_index",size:1,type:Z.FLOAT},{name:"a_hitColor",size:4,type:Z.FLOAT},{name:"a_featureUid",size:1,type:Z.FLOAT}].concat(n),this.customAttributes=t.attributes?t.attributes:[],this.previousExtent_=(0,re.createEmpty)(),this.currentTransform_=i,this.renderTransform_=(0,k.create)(),this.invertRenderTransform_=(0,k.create)(),this.renderInstructions_=new Float32Array(0),this.hitRenderInstructions_=new Float32Array(0),this.hitRenderTarget_,this.generateBuffersRun_=0,this.worker_=Dt(),this.worker_.addEventListener("message",function(e){const t=e.data;if(t.type===te.GENERATE_POINT_BUFFERS){const r=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,(0,k.makeInverse)(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):(this.renderInstructions_=new Float32Array(e.data.renderInstructions),t.generateBuffersRun===this.generateBuffersRun_&&(this.ready=!0)),this.getLayer().changed()}}.bind(this)),this.featureCache_={},this.featureCount_=0;const s=this.getLayer().getSource();this.sourceListenKeys_=[(0,zt.listen)(s,E.default.ADDFEATURE,this.handleSourceFeatureAdded_,this),(0,zt.listen)(s,E.default.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),(0,zt.listen)(s,E.default.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),(0,zt.listen)(s,E.default.CLEAR,this.handleSourceFeatureClear_,this)],s.forEachFeature(function(e){this.featureCache_[(0,O.getUid)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(this))}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new ee(this.helper))}handleSourceFeatureAdded_(e){const t=e.feature;this.featureCache_[(0,O.getUid)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++}handleSourceFeatureChanged_(e){const t=e.feature;this.featureCache_[(0,O.getUid)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}}handleSourceFeatureDelete_(e){const t=e.feature;delete this.featureCache_[(0,O.getUid)(t)],this.featureCount_--}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const r=e.viewState.projection,i=this.getLayer().getSource().getWrapX()&&r.canWrapX(),n=r.getExtent(),s=e.extent,a=i?(0,re.getWidth)(n):null,o=i?Math.ceil((s[2]-n[2])/a)+1:1,l=i?Math.floor((s[0]-n[0])/a):0;let h=l;const u=this.indicesBuffer_.getSize();do{this.helper.makeProjectionTransform(e,this.currentTransform_),(0,k.translate)(this.currentTransform_,h*a,0),(0,k.multiply)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e),this.helper.drawElements(0,u)}while(++h<o);this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const c=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(e,l,o,a),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),c}prepareFrameInternal(e){const t=this.getLayer(),r=t.getSource(),i=e.viewState,n=!e.viewHints[w.default.ANIMATING]&&!e.viewHints[w.default.INTERACTING],s=!(0,re.equals)(this.previousExtent_,e.extent),a=this.sourceRevision_<r.getRevision();if(a&&(this.sourceRevision_=r.getRevision()),n&&(s||a)){const n=i.projection,s=i.resolution,a=t instanceof b.default?t.getRenderBuffer():0,o=(0,re.buffer)(e.extent,a*s);r.loadFeatures(o,s,n),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.useProgram(this.program_,e),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(e){const t=(0,k.create)();this.helper.makeProjectionTransform(e,t);const r=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===r||(this.renderInstructions_=new Float32Array(r)),this.hitDetectionEnabled_){const e=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===e||(this.hitRenderInstructions_=new Float32Array(e))}let i,n;const s=[],a=[];let o,l=0,h=0;for(const e in this.featureCache_){if(i=this.featureCache_[e],n=i.geometry,!n||"Point"!==n.getType())continue;let r;s[0]=n.getFlatCoordinates()[0],s[1]=n.getFlatCoordinates()[1],(0,k.apply)(t,s),o=Ce(h+6,a),this.renderInstructions_[l++]=s[0],this.renderInstructions_[l++]=s[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[h++]=s[0],this.hitRenderInstructions_[h++]=s[1],this.hitRenderInstructions_[h++]=o[0],this.hitRenderInstructions_[h++]=o[1],this.hitRenderInstructions_[h++]=o[2],this.hitRenderInstructions_[h++]=o[3],this.hitRenderInstructions_[h++]=Number(e));for(let e=0;e<this.customAttributes.length;e++)r=this.customAttributes[e].callback(i.feature,i.properties),this.renderInstructions_[l++]=r,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[h++]=r)}const u={id:0,type:te.GENERATE_POINT_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(u.projectionTransform=t,u.generateBuffersRun=++this.generateBuffersRun_,this.ready=!1,this.worker_.postMessage(u,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){const e={id:0,type:te.GENERATE_POINT_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};e.projectionTransform=t,e.hitDetection=!0,this.worker_.postMessage(e,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}}forEachFeatureAtCoordinate(e,t,r,i,n){if((0,I.assert)(this.hitDetectionEnabled_,66),!this.hitRenderInstructions_)return;const s=(0,k.apply)(t.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(s[0]/2,s[1]/2),o=Be([a[0]/255,a[1]/255,a[2]/255,a[3]/255]),l=this.hitRenderInstructions_[o],h=Math.floor(l).toString(),u=this.getLayer().getSource().getFeatureByUid(h);return u?i(u,this.getLayer(),null):void 0}renderHitDetection(e,t,r,i){if(!this.hitVerticesBuffer_.getSize())return;let n=t;this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_,e),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(e,this.currentTransform_),(0,k.translate)(this.currentTransform_,n*i,0),(0,k.multiply)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e);const t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}while(++n<r)}disposeInternal(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach((function(e){(0,zt.unlistenByKey)(e)})),this.sourceListenKeys_=null,super.disposeInternal()}},Gt=(Re=n("a6roo"),n("cgxQK"));const Vt="blur",Zt="gradient",Wt="radius",jt=["#00f","#0ff","#0f0","#ff0","#f00"];class Ht extends b.default{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.gradient_=null,this.addChangeListener(Zt,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:jt),this.setBlur(void 0!==e.blur?e.blur:15),this.setRadius(void 0!==e.radius?e.radius:8);const r=e.weight?e.weight:"weight";this.weightFunction_="string"==typeof r?function(e){return e.get(r)}:r,this.setRenderOrder(null)}getBlur(){return this.get(Vt)}getGradient(){return this.get(Zt)}getRadius(){return this.get(Wt)}handleGradientChanged_(){this.gradient_=function(e){const t=1,r=256,i=(0,Gt.createCanvasContext2D)(t,r),n=i.createLinearGradient(0,0,t,r),s=1/(e.length-1);for(let t=0,r=e.length;t<r;++t)n.addColorStop(t*s,e[t]);return i.fillStyle=n,i.fillRect(0,0,t,r),i.canvas}(this.getGradient())}setBlur(e){this.set(Vt,e)}setGradient(e){this.set(Zt,e)}setRadius(e){this.set(Wt,e)}createRenderer(){return new kt(this,{className:this.getClassName(),attributes:[{name:"weight",callback:function(e){const t=this.weightFunction_(e);return void 0!==t?(0,Re.clamp)(t,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(Wt)+this.get(Vt))}.bind(this),u_blurSlope:function(){return this.get(Wt)/Math.max(1,this.get(Vt))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n            uniform float u_opacity;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a * u_opacity;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this),u_opacity:function(){return this.getOpacity()}.bind(this)}}]})}renderDeclutter(){}}var Xt=Ht,qt=(re=n("jZquI"),p=n("iQyfo"),class extends m.default{constructor(e){e=e||{};var t=p.default.create("DIV",{className:e.switcherClass||"ol-layerswitcher"});super({element:t,target:e.target});var r=this;this.dcount=0,this.show_progress=e.show_progress,this.oninfo="function"==typeof e.oninfo?e.oninfo:null,this.onextent="function"==typeof e.onextent?e.onextent:null,this.hasextent=e.extent||e.onextent,this.hastrash=e.trash,this.reordering=!1!==e.reordering,this._layers=[],this._layerGroup=e.layerGroup&&e.layerGroup.getLayers?e.layerGroup:null,this.onchangeCheck="function"==typeof e.onchangeCheck?e.onchangeCheck:null,"function"==typeof e.displayInLayerSwitcher&&(this.displayInLayerSwitcher=e.displayInLayerSwitcher),e.target||(t.classList.add("ol-unselectable"),t.classList.add("ol-control"),t.classList.add(!1!==e.collapsed?"ol-collapsed":"ol-forceopen"),this.button=p.default.create("BUTTON",{type:"button",parent:t}),this.button.addEventListener("touchstart",(function(e){t.classList.toggle("ol-forceopen"),t.classList.add("ol-collapsed"),r.dispatchEvent({type:"toggle",collapsed:t.classList.contains("ol-collapsed")}),e.preventDefault(),r.overflow()})),this.button.addEventListener("click",(function(){t.classList.toggle("ol-forceopen"),t.classList.add("ol-collapsed"),r.dispatchEvent({type:"toggle",collapsed:!t.classList.contains("ol-forceopen")}),r.overflow()})),e.mouseover&&(t.addEventListener("mouseleave",(function(){t.classList.add("ol-collapsed"),r.dispatchEvent({type:"toggle",collapsed:!0})})),t.addEventListener("mouseover",(function(){t.classList.remove("ol-collapsed"),r.dispatchEvent({type:"toggle",collapsed:!1})}))),e.minibar&&(e.noScroll=!0),e.noScroll||(this.topv=p.default.create("DIV",{className:"ol-switchertopdiv",parent:t,click:function(){r.overflow("+50%")}}),this.botv=p.default.create("DIV",{className:"ol-switcherbottomdiv",parent:t,click:function(){r.overflow("-50%")}})),this._noScroll=e.noScroll),this.panel_=p.default.create("UL",{className:"panel"}),this.panelContainer_=p.default.create("DIV",{className:"panel-container",html:this.panel_,parent:t}),e.target||e.noScroll||p.default.addListener(this.panel_,"mousewheel DOMMouseScroll onmousewheel",(function(e){r.overflow(Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)))&&(e.stopPropagation(),e.preventDefault())})),this.header_=p.default.create("LI",{className:"ol-header",parent:this.panel_}),this.set("drawDelay",e.drawDelay||0),this.set("selection",e.selection),e.minibar&&setTimeout(function(){var e=p.default.scrollDiv(this.panelContainer_,{mousewheel:!0,vertical:!0,minibar:!0});this.on(["drawlist","toggle"],(function(){e.refresh()}))}.bind(this))}displayInLayerSwitcher(e){return!1!==e.get("displayInLayerSwitcher")}setMap(e){if(super.setMap(e),this.drawPanel(),this._listener)for(var t in this._listener)(0,h.unByKey)(this._listener[t]);this._listener=null,e&&(this._listener={moveend:e.on("moveend",this.viewChange.bind(this)),size:e.on("change:size",this.overflow.bind(this))},this._layerGroup?this._listener.change=this._layerGroup.getLayers().on("change:length",this.drawPanel.bind(this)):this._listener.change=e.getLayerGroup().getLayers().on("change:length",this.drawPanel.bind(this)))}show(){this.element.classList.add("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!1})}hide(){this.element.classList.remove("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!0})}toggle(){this.element.classList.toggle("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!this.isOpen()})}isOpen(){return this.element.classList.contains("ol-forceopen")}setHeader(e){p.default.setHTML(this.header_,e)}overflow(e){if(this.button&&!this._noScroll){if(p.default.hidden(this.panel_))return void p.default.setStyle(this.element,{height:"auto"});var t=p.default.outerHeight(this.element),r=p.default.outerHeight(this.panel_),i=this.button.offsetTop+p.default.outerHeight(this.button),n=this.panel_.offsetTop-i;if(r>t-i){p.default.setStyle(this.element,{height:"100%"});var s=this.panel_.querySelectorAll("li.visible .li-content")[0],a=s?2*p.default.getStyle(s,"height"):0;switch(e){case 1:n+=a;break;case-1:n-=a;break;case"+50%":n+=Math.round(t/2);break;case"-50%":n-=Math.round(t/2)}return n+r<=t-3*i/2?(n=t-3*i/2-r,p.default.hide(this.botv)):p.default.show(this.botv),n>=0?(n=0,p.default.hide(this.topv)):p.default.show(this.topv),p.default.setStyle(this.panel_,{top:n+"px"}),!0}return p.default.setStyle(this.element,{height:"auto"}),p.default.setStyle(this.panel_,{top:0}),p.default.hide(this.botv),p.default.hide(this.topv),!1}return!1}_setLayerForLI(e,t){var r=[];t.getLayers&&r.push(t.getLayers().on("change:length",this.drawPanel.bind(this))),e&&(r.push(t.on("change:opacity",function(){this.setLayerOpacity(t,e)}.bind(this))),r.push(t.on("change:visible",function(){this.setLayerVisibility(t,e)}.bind(this)))),r.push(t.on("propertychange",function(e){"displayInLayerSwitcher"!==e.key&&"openInLayerSwitcher"!==e.key&&"title"!==e.key&&"name"!==e.key||this.drawPanel(e)}.bind(this))),this._layers.push({li:e,layer:t,listeners:r})}setLayerOpacity(e,t){var r=t.querySelector(".layerswitcher-opacity-cursor");r&&(r.style.left=100*e.getOpacity()+"%"),this.dispatchEvent({type:"layer:opacity",layer:e})}setLayerVisibility(e,t){var r=t.querySelector(".ol-visibility");r&&(r.checked=e.getVisible()),e.getVisible()?t.classList.add("ol-visible"):t.classList.remove("ol-visible"),this.dispatchEvent({type:"layer:visible",layer:e})}_clearLayerForLI(){this._layers.forEach((function(e){e.listeners.forEach((function(e){(0,h.unByKey)(e)}))})),this._layers=[]}_getLayerForLI(e){for(var t,r=0;t=this._layers[r];r++)if(t.li===e)return t.layer;return null}viewChange(){this.panel_.querySelectorAll("li").forEach(function(e){var t=this._getLayerForLI(e);t&&(this.testLayerVisibility(t)?e.classList.remove("ol-layer-hidden"):e.classList.add("ol-layer-hidden"))}.bind(this))}getPanel(){return this.panelContainer_}drawPanel(){if(this.getMap()){var e=this;this.dcount++,setTimeout((function(){e.drawPanel_()}),this.get("drawDelay")||0)}}drawPanel_(){if(!--this.dcount&&!this.dragging_){var e=this.panelContainer_.scrollTop;this._clearLayerForLI(),this.panel_.querySelectorAll("li").forEach(function(e){e.classList.contains("ol-header")||e.remove()}.bind(this)),this._layerGroup?this.drawList(this.panel_,this._layerGroup.getLayers()):this.getMap()&&this.drawList(this.panel_,this.getMap().getLayers()),this.panelContainer_.scrollTop=e}}switchLayerVisibility(e,t){e.get("baseLayer")?(e.getVisible()||e.setVisible(!0),t.forEach((function(t){e!==t&&t.get("baseLayer")&&t.getVisible()&&t.setVisible(!1)}))):e.setVisible(!e.getVisible())}testLayerVisibility(e){if(!this.getMap())return!0;var t=this.getMap().getView().getResolution(),r=this.getMap().getView().getZoom();if(e.getMaxResolution()<=t||e.getMinResolution()>=t)return!1;if(e.getMinZoom&&(e.getMinZoom()>=r||e.getMaxZoom()<r))return!1;var i=e.getExtent();if(i){var n=this.getMap().getView().calculateExtent(this.getMap().getSize());return(0,re.intersects)(n,i)}return!0}dragOrdering_(e){e.stopPropagation(),e.preventDefault();var t,r,i,n,s,a=this,o=e.currentTarget.parentNode.parentNode,l=!0,h=this.panel_,u=e.pageY||e.touches&&e.touches.length&&e.touches[0].pageY||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageY;function c(e){if(t=e.pageY||e.touches&&e.touches.length&&e.touches[0].pageY||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageY,l&&Math.abs(u-t)>2&&(l=!1,o.classList.add("drag"),n=a._getLayerForLI(o),r=!1,s=a._getLayerForLI(o.parentNode.parentNode),i=p.default.create("LI",{className:"ol-dragover",html:o.innerHTML,style:{position:"absolute","z-index":1e4,left:o.offsetLeft,opacity:.5,width:p.default.outerWidth(o),height:p.default.getStyle(o,"height")},parent:h}),a.element.classList.add("drag"),a.dispatchEvent({type:"reorder-start",layer:n,group:s})),!l){var c;for(e.preventDefault(),e.stopPropagation(),p.default.setStyle(i,{top:t-p.default.offsetRect(h).top+h.scrollTop+5}),(c=e.touches?document.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY):e.target).classList.contains("ol-switcherbottomdiv")?a.overflow(-1):c.classList.contains("ol-switchertopdiv")&&a.overflow(1);c&&"LI"!==c.tagName;)c=c.parentNode;c&&c.classList.contains("dropover")||o.parentNode.querySelectorAll("li").forEach((function(e){e.classList.remove("dropover"),e.classList.remove("dropover-after"),e.classList.remove("dropover-before")})),c&&c.parentNode.classList.contains("drag")&&c!==o?((r=a._getLayerForLI(c))&&!r.get("allwaysOnTop")==!n.get("allwaysOnTop")?(c.classList.add("dropover"),c.classList.add(o.offsetTop<c.offsetTop?"dropover-after":"dropover-before")):r=!1,p.default.show(i)):(r=!1,c===o?p.default.hide(i):p.default.show(i)),r?i.classList.remove("forbidden"):i.classList.add("forbidden")}}o.parentNode.classList.add("drag"),p.default.addListener(document,"mousemove touchmove",c),p.default.addListener(document,"mouseup touchend touchcancel",(function e(){if(r){var t=n,l=a.getSelection()===t;if(t&&r){for(var h,u=(h=s?s.getLayers():a._layerGroup?a._layerGroup.getLayers():a.getMap().getLayers()).getArray(),f=0;f<u.length;f++)if(u[f]==t){h.removeAt(f);break}for(var d=0;d<u.length;d++)if(u[d]===r){f>d?h.insertAt(d,t):h.insertAt(d+1,t);break}}l&&a.selectLayer(t),a.dispatchEvent({type:"reorder-end",layer:t,group:s})}o.parentNode.querySelectorAll("li").forEach((function(e){e.classList.remove("dropover"),e.classList.remove("dropover-after"),e.classList.remove("dropover-before")})),o.classList.remove("drag"),o.parentNode.classList.remove("drag"),a.element.classList.remove("drag"),i&&i.remove(),p.default.removeListener(document,"mousemove touchmove",c),p.default.removeListener(document,"mouseup touchend touchcancel",e)}))}dragOpacity_(e){e.stopPropagation(),e.preventDefault();var t=this,r=e.target,i=this._getLayerForLI(r.parentNode.parentNode.parentNode);if(i){var n=e.pageX||e.touches&&e.touches.length&&e.touches[0].pageX||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageX,s=p.default.getStyle(r,"left")-n;t.dragging_=!0,p.default.addListener(document,"mouseup touchend touchcancel",(function e(){p.default.removeListener(document,"mouseup touchend touchcancel",e),p.default.removeListener(document,"mousemove touchmove",a),t.dragging_=!1})),p.default.addListener(document,"mousemove touchmove",a)}function a(e){var t=e.pageX||e.touches&&e.touches.length&&e.touches[0].pageX||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageX,n=(s+t)/p.default.getStyle(r.parentNode,"width"),a=Math.max(0,Math.min(1,n));p.default.setStyle(r,{left:100*a+"%"}),r.parentNode.nextElementSibling.innerHTML=Math.round(100*a),i.setOpacity(a)}}drawList(e,t){var r=this,i=t.getArray(),n=function(e){e.stopPropagation(),e.preventDefault();var i=r._getLayerForLI(this.parentNode.parentNode);r.switchLayerVisibility(i,t),r.get("selection")&&i.getVisible()&&r.selectLayer(i),r.onchangeCheck&&r.onchangeCheck(i)};function s(e){e.stopPropagation(),e.preventDefault();var t=r._getLayerForLI(this.parentNode.parentNode);r.oninfo(t),r.dispatchEvent({type:"info",layer:t})}function a(e){e.stopPropagation(),e.preventDefault();var t=r._getLayerForLI(this.parentNode.parentNode);r.onextent?r.onextent(t):r.getMap().getView().fit(t.getExtent(),r.getMap().getSize()),r.dispatchEvent({type:"extent",layer:t})}function o(e){e.stopPropagation(),e.preventDefault();var t,i=this.parentNode.parentNode.parentNode.parentNode,n=r._getLayerForLI(i);n?(t=r._getLayerForLI(this.parentNode.parentNode),n.getLayers().remove(t),0!=n.getLayers().getLength()||n.get("noSwitcherDelete")||o.call(i.querySelectorAll(".layerTrash")[0],e)):(i=this.parentNode.parentNode,r.getMap().removeLayer(r._getLayerForLI(i)))}function l(t){if(this.displayInLayerSwitcher(t)){var l=p.default.create("LI",{className:(t.getVisible()?"visible ":" ")+(t.get("baseLayer")?"baselayer":""),parent:e});this._setLayerForLI(l,t),this._selectedLayer===t&&l.classList.add("ol-layer-select");var u=p.default.create("DIV",{className:"ol-layerswitcher-buttons",parent:l}),c=p.default.create("DIV",{className:"li-content",parent:l});p.default.create("INPUT",{type:t.get("baseLayer")?"radio":"checkbox",className:"ol-visibility",checked:t.getVisible(),click:n,parent:c});var f=p.default.create("LABEL",{title:t.get("title")||t.get("name"),click:n,style:{userSelect:"none"},parent:c});if(f.addEventListener("selectstart",(function(){return!1})),p.default.create("SPAN",{html:t.get("title")||t.get("name"),click:function(e){this.get("selection")&&(e.stopPropagation(),this.selectLayer(t))}.bind(this),parent:f}),this.reordering&&(h<i.length-1&&(t.get("allwaysOnTop")||!i[h+1].get("allwaysOnTop"))||h>0&&(!t.get("allwaysOnTop")||i[h-1].get("allwaysOnTop")))&&p.default.create("DIV",{className:"layerup ol-noscroll",title:this.tip.up,on:{"mousedown touchstart":function(e){r.dragOrdering_(e)}},parent:u}),t.getLayers){var d=0;t.getLayers().forEach((function(e){r.displayInLayerSwitcher(e)&&d++})),d&&p.default.create("DIV",{className:t.get("openInLayerSwitcher")?"collapse-layers":"expend-layers",title:this.tip.plus,click:function(){var e=r._getLayerForLI(this.parentNode.parentNode);e.set("openInLayerSwitcher",!e.get("openInLayerSwitcher"))},parent:u})}if(this.oninfo&&p.default.create("DIV",{className:"layerInfo",title:this.tip.info,click:s,parent:u}),this.hastrash&&!t.get("noSwitcherDelete")&&p.default.create("DIV",{className:"layerTrash",title:this.tip.trash,click:o,parent:u}),this.hasextent&&i[h].getExtent()){var g=i[h].getExtent();4==g.length&&g[0]<g[2]&&g[1]<g[3]&&p.default.create("DIV",{className:"layerExtent",title:this.tip.extent,click:a,parent:u})}if(this.show_progress&&t instanceof y.default){var m=p.default.create("DIV",{className:"layerswitcher-progress",parent:c});this.setprogress_(t),t.layerswitcher_progress=p.default.create("DIV",{parent:m})}var v=p.default.create("DIV",{className:"layerswitcher-opacity",click:function(e){if(e.target===this){e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(1,e.offsetX/p.default.getStyle(this,"width")));r._getLayerForLI(this.parentNode.parentNode).setOpacity(t),this.parentNode.querySelectorAll(".layerswitcher-opacity-label")[0].innerHTML=Math.round(100*t)}},parent:c});if(p.default.create("DIV",{className:"layerswitcher-opacity-cursor ol-noscroll",style:{left:100*t.getOpacity()+"%"},on:{"mousedown touchstart":function(e){r.dragOpacity_(e)}},parent:v}),p.default.create("DIV",{className:"layerswitcher-opacity-label",html:Math.round(100*t.getOpacity()),parent:c}),t.getLayers&&(l.classList.add("ol-layer-group"),!0===t.get("openInLayerSwitcher"))){var _=p.default.create("UL",{parent:l});this.drawList(_,t.getLayers())}l.classList.add(this.getLayerClass(t)),this.dispatchEvent({type:"drawlist",layer:t,li:l})}else this._setLayerForLI(null,t)}for(var h=i.length-1;h>=0;h--)l.call(this,i[h]);this.viewChange(),e===this.panel_&&this.overflow()}getLayerClass(e){return e?e.getLayers?"ol-layer-group":e instanceof v.default?"ol-layer-vector":e instanceof _.default?"ol-layer-vectortile":e instanceof y.default?"ol-layer-tile":e instanceof x.default?"ol-layer-image":e instanceof Xt?"ol-layer-heatmap":e.getFeatures?"ol-layer-vectorimage":"unknown":"none"}selectLayer(e,t){if(!e){if(!this.getMap())return;e=this.getMap().getLayers().item(this.getMap().getLayers().getLength()-1)}this._selectedLayer=e,this.drawPanel(),t||this.dispatchEvent({type:"select",layer:e})}getSelection(){return this._selectedLayer}setprogress_(e){if(!e.layerswitcher_progress){var t=0,r=0,i=function(){r===t?(r=t=0,p.default.setStyle(e.layerswitcher_progress,{width:0})):p.default.setStyle(e.layerswitcher_progress,{width:(t/r*100).toFixed(1)+"%"})};e.getSource().on("tileloadstart",(function(){r++,i()})),e.getSource().on("tileloadend",(function(){t++,i()})),e.getSource().on("tileloaderror",(function(){t++,i()}))}}});qt.prototype.tip={up:"up/down",down:"down",info:"informations...",extent:"zoom to extent",trash:"remove layer",plus:"expand/shrink"};var Yt=qt,$t=(h=n("ejLRd"),m=n("4DafG"),n("d5AAH")),Kt=(p=n("iQyfo"),n("6od7S")),Qt=(f=n("lqNjm"),d=n("6sFdl"),n("fnScq")),Jt=(h=n("ejLRd"),n("31ZqB")),er=(T=n("lW8xZ"),n("htGzg")),tr=(T=n("lW8xZ"),k=n("14PDX"),n("713Fw"),n("gzr8q"));function rr(e,t){const r=e.canvas,i=(t=t||{}).pixelRatio||T.DEVICE_PIXEL_RATIO,n=t.size;n&&(r.width=n[0]*i,r.height=n[1]*i,r.style.width=n[0]+"px",r.style.height=n[1]+"px");const s=[0,0,r.width,r.height],a=(0,k.scale)((0,k.create)(),i,i);return new(0,er.default)(e,i,s,a,0)}f=n("lqNjm");var ir=n("iGyOD"),nr=n("j2K3b"),sr=n("hvEnP"),ar=n("cgPpQ"),or=(re=n("jZquI"),p=n("iQyfo"),n("kuKBR")),lr=n("2zf1Y"),hr=(Qt=n("fnScq"),p=n("iQyfo"),class extends Qt.default{constructor(e){super(e=e||{}),e.feature&&this.set("feature",e.feature.clone()),this.setWidth(e.width),this.setHeight(e.height)}setTitle(e){this.set("title",e||""),this.changed()}setWidth(e){this.set("width",e||null),this.changed()}setHeight(e){this.set("heigth",e||null),this.changed()}getElement(e,t){this.get("width")&&(e[1]=this.get("width")),this.get("height")&&(e[1]=this.get("height"));var r=p.default.create("LI",{className:this.get("className"),click:function(e){t(!1),e.stopPropagation()},style:{height:e[1]+"px"},"aria-label":this.get("title")});return p.default.create("DIV",{click:function(e){t(!0),e.stopPropagation()},style:{width:e[0]+"px",height:e[1]+"px"},parent:r}),r}}),ur=(Qt=n("fnScq"),p=n("iQyfo"),class extends Qt.default{constructor(e){super(e=e||{}),this.set("width",e.width),this._img=e.img||new Image,this._img.onload=function(){this.changed()}.bind(this),e.img||(this._img.src=e.src)}setTitle(e){this.set("title",e||""),this.changed()}setWidth(e){this.set("width",e||null),this.changed()}getWidth(){return this._img.naturalWidth?this.get("width")||this._img.naturalWidth:0}getHeight(){return this._img.naturalWidth?this.get("width")?this.get("width")*this._img.naturalHeight/this._img.naturalWidth:this._img.naturalHeight||0:0}getImage(){return this._img}getElement(e,t){this.get("width")&&(e[1]=this.get("width")),this.get("height")&&(e[1]=this.get("height"));var r=p.default.create("LI",{className:this.get("className"),click:function(e){t(!1),e.stopPropagation()},style:{height:this.getHeight()+"px"},"aria-label":this.get("title")});return p.default.create("DIV",{click:function(e){t(!0),e.stopPropagation()},style:{width:this.getWidth()+"px",height:this.getHeight()+"px"},parent:r}),r}});window.ol&&!ol.legend&&(ol.legend={});var cr=class extends Qt.default{constructor(e){super(),e=e||{},this._items=new(0,Jt.default);var t,r=[];this._items.on("add",function(e){r.push({item:e.element,on:e.element.on("change",function(){this.refresh()}.bind(this))}),t&&(clearTimeout(t),t=null),t=setTimeout(function(){this.refresh()}.bind(this),0)}.bind(this)),this._items.on("remove",function(e){for(var i=0;i<r;i++)if(e.element===r[i].item){(0,h.unByKey)(r[i].on),r.splice(i,1);break}t&&(clearTimeout(t),t=null),t=setTimeout(function(){this.refresh()}.bind(this),0)}.bind(this)),this._listElement=p.default.create("UL",{className:"ol-legend"}),this._canvas=document.createElement("canvas"),this.setLayer(e.layer),this.set("maxWidth",e.maxWidth,!0),this.set("size",e.size||[40,25],!0),this.set("margin",0===e.margin?0:e.margin||10,!0),this._textStyle=e.textStyle||new(0,or.default)({font:"16px sans-serif",fill:new(0,lr.default)({color:"#333"}),backgroundFill:new(0,lr.default)({color:"rgba(255,255,255,.8)"})}),this._title=new hr({title:e.title||"",className:"ol-title"}),e.titleStyle?this._titleStyle=e.titleStyle:(this._titleStyle=this._textStyle.clone(),this._titleStyle.setFont("bold "+this._titleStyle.getFont())),this.setStyle(e.style),e.items instanceof Array&&e.items.forEach(function(e){this.addItem(e)}.bind(this)),this.refresh()}static getLegendImage(e,t,r){void 0===(e=e||{}).margin&&(e.margin=10);var i=e.size||[40,25];e.width&&(i[0]=e.width),e.heigth&&(i[1]=e.heigth),e.onload=e.onload||function(){setTimeout((function(){cr.getLegendImage(e,t,r)}),100)};var n=i[0]+2*e.margin,s=e.lineHeight||i[1]+2*e.margin,a=e.pixelratio||T.DEVICE_PIXEL_RATIO;t||(r=0,(t=document.createElement("canvas")).width=n*a,t.height=s*a);var o=t.getContext("2d");o.save();var l,h=rr(o,{pixelRatio:a}),u=e.typeGeom,c=e.feature;!c&&u&&(c=/Point/.test(u)?new(0,ir.default)(new(0,nr.default)([0,0])):/LineString/.test(u)?new(0,ir.default)(new(0,sr.default)([0,0])):new(0,ir.default)(new(0,ar.default)([[0,0]])),e.properties&&c.setProperties(e.properties)),c?("function"==typeof(l=c.getStyle())&&(l=l(c)),l||(l="function"==typeof e.style?e.style(c):e.style||[]),u=c.getGeometry().getType()):l=[],l instanceof Array||(l=[l]);var f,d,p=n/2,g=s/2,m=i[0]/2,y=i[1]/2;if("Point"===u){var v=null;for(f=0;d=l[f];f++){var _=d.getImage();if(_){var x=_.getPhoto?_.getPhoto():_.getImage();if(x&&x instanceof HTMLImageElement&&!x.naturalWidth&&("function"==typeof e.onload&&x.addEventListener("load",(function(){setTimeout((function(){e.onload()}),100)})),_.load()),_.getAnchor){var b=_.getAnchor();if(b){var E=_.getSize(),w=b[0]-E[0],L=b[1]-E[1];v?(0,re.extend)(v,[w,L,w+E[0],L+E[1]]):v=[w,L,w+E[0],L+E[1]]}}}}v&&(p+=(v[2]+v[0])/2,g+=(v[3]+v[1])/2)}for(g+=r||0,f=0;d=l[f];f++){var S;switch(h.setStyle(d),o.save(),u){case nr.default:case"Point":case"MultiPoint":S=new(0,nr.default)([p,g]);break;case sr.default:case"LineString":case"MultiLineString":o.rect(e.margin*a,0,i[0]*a,t.height),o.clip(),S=new(0,sr.default)([[p-m,g],[p+m,g]]);break;case ar.default:case"Polygon":case"MultiPolygon":S=new(0,ar.default)([[[p-m,g-y],[p+m,g-y],[p+m,g+y],[p-m,g+y],[p-m,g-y]]])}d.getGeometryFunction()&&(S=d.getGeometryFunction()(new(0,ir.default)(S))),h.drawGeometry(S),o.restore()}return o.restore(),t}setTitle(e){this._title.setTitle(e),this.refresh()}getTitle(){return this._title.get("title")}setLayer(e){this._layerListener&&(0,h.unByKey)(this._layerListener),this._layer=e,this._layerListener=e?e.on("change:visible",function(){this.refresh()}.bind(this)):null}getTextStyle(){return this._textStyle}set(e,t,r){super.set(e,t,r),r||this.refresh()}getListElement(){return this._listElement}getCanvas(){return this._canvas}setStyle(e){this._style=e,this.refresh()}addItem(e){e instanceof cr?(this._items.push(e),e.on("refresh",function(){this.refresh(!0)}.bind(this))):e instanceof hr||e instanceof ur?this._items.push(e):this._items.push(new hr(e))}removeItem(e){this._items.remove(e)}removeItemAt(e){this._items.removeAt(e)}getItems(){return this._items}_drawText(e,t,r,i){e.save(),e.scale(T.DEVICE_PIXEL_RATIO,T.DEVICE_PIXEL_RATIO);var n=(t=t||"").split("\n");1===n.length?e.fillText(t,r,i):(e.textBaseline="bottom",e.fillText(n[0],r,i),e.textBaseline="top",e.fillText(n[1],r,i)),e.restore()}_measureText(e,t){var r=(t||"").split("\n");if(1===r.length)return e.measureText(t);var i=e.measureText(r[0]),n=e.measureText(r[1]);return{width:Math.max(i.width,n.width),height:i.height+n.height}}refresh(e){var t=this._listElement;if(t){t.innerHTML="";var r=this.get("margin"),i=this.get("size")[0]+2*r,n=this.get("lineHeight")||this.get("size")[1]+2*r,s=this.getCanvas(),a=s.getContext("2d");a.textAlign="left",a.textBaseline="middle";var o=T.DEVICE_PIXEL_RATIO,l=Math.min(this.getWidth(),this.get("maxWidth")||1/0),h=this.getHeight();s.width=l*o,s.height=h*o,s.style.height=h+"px",a.textBaseline="middle",a.fillStyle=(0,f.asString)(this._textStyle.getFill().getColor()),this.getTitle()&&(t.appendChild(this._title.getElement([i,n],function(e){this.dispatchEvent({type:"select",index:-1,symbol:e,item:this._title})}.bind(this))),a.font=this._titleStyle.getFont(),a.textAlign="center",this._drawText(a,this.getTitle(),s.width/o/2,n/2));var u=0;this.getTitle()&&(u=n),this._items.forEach(function(e,l){if(e instanceof cr){if((!e._layer||e._layer.getVisible())&&e.getCanvas().height){a.drawImage(e.getCanvas(),0,u*o);for(var h=e._listElement.querySelectorAll("li"),c=0;c<h.length;c++){var f=h[c].cloneNode();f.innerHTML=h[c].innerHTML,t.appendChild(f)}u+=e.getHeight()}}else{if(e instanceof ur){e.get("title")&&(t.appendChild(this._title.getElement([i,n],function(e){this.dispatchEvent({type:"select",index:-1,symbol:e,item:this._title})}.bind(this))),a.font=e.get("textStyle")?e.get("textStyle").getFont():this._titleStyle.getFont(),/\bcenter\b/.test(e.get("className"))?(a.textAlign="center",this._drawText(a,e.get("title"),s.width/o/2,u+n/2)):this._drawText(a,e.get("title"),r,u+n/2),u+=n);var d=e.getImage();a.drawImage(d,0,0,d.naturalWidth,d.naturalHeight,0,u*o,e.getWidth()*o,e.getHeight()*o),u+=e.getHeight()}else{var p=e.getProperties(),g=p.height||n;a.textAlign="left",p.feature||p.typeGeom?(s=this.getLegendImage(p,s,u),a.font=e.get("textStyle")?e.get("textStyle").getFont():this._textStyle.getFont(),this._drawText(a,e.get("title"),i+r,u+g/2)):(a.font=e.get("textStyle")?e.get("textStyle").getFont():this._titleStyle.getFont(),/\bcenter\b/.test(p.className)?(a.textAlign="center",this._drawText(a,e.get("title"),s.width/o/2,u+g/2)):this._drawText(a,e.get("title"),r,u+g/2)),u+=g}t.appendChild(e.getElement([i,n],function(t){this.dispatchEvent({type:"select",index:l,symbol:t,item:e})}.bind(this)))}}.bind(this)),e||this.dispatchEvent({type:"refresh",width:i,height:(this._items.length+1)*n})}}getHeight(){var e=this.get("margin"),t=this.get("lineHeight")||this.get("size")[1]+2*e,r=this.getTitle()?t:0;return this._items.forEach((function(i){i instanceof cr?i._layer&&!i._layer.getVisible()||(r+=i.getHeight()):i instanceof ur?(i.get("title")&&(r+=t),r+=i.getHeight()):i.get("height")?r+=i.get("height")+2*e:r+=t})),r}getWidth(){var e=this.getCanvas().getContext("2d"),t=this.get("margin"),r=this.get("size")[0]+2*t;e.font=this._titleStyle.getFont();var i=this._measureText(e,this.getTitle("title")).width;return this._items.forEach(function(t){t instanceof cr?t._layer&&!t._layer.getVisible()||(i=Math.max(i,t.getWidth())):t instanceof ur?(i=Math.max(i,t.getWidth()),t.get("title")&&(e.font=t.get("textStyle")?t.get("textStyle").getFont():this._titleStyle.getFont(),i=Math.max(i,this._measureText(e,t.get("title")).width))):t.get("feature")||t.get("typeGeom")?(e.font=t.get("textStyle")?t.get("textStyle").getFont():this._textStyle.getFont(),i=Math.max(i,this._measureText(e,t.get("title")).width+r)):(e.font=t.get("textStyle")?t.get("textStyle").getFont():this._titleStyle.getFont(),i=Math.max(i,this._measureText(e,t.get("title")).width))}.bind(this)),i+2*t}getLegendImage(e,t,r){e=e||{};var i=this.get("size");return cr.getLegendImage({className:e.className,feature:e.feature,typeGeom:e.typeGeom,style:e.style||this._style,properties:e.properties,margin:e.margin||this.get("margin"),size:[e.width||i[0],e.height||i[1]],lineHeight:e.lineHeight||this.get("lineHeight"),onload:function(){this.refresh()}.bind(this)},t,r)}};n("iQyfo");var fr=class extends d.default{constructor(e){e=e||{};var t=document.createElement("div");if(super({element:t,target:e.target}),e.target)t.className=e.className||"ol-legend";else{t.className=(e.className||"ol-legend")+" ol-unselectable ol-control"+(!1===e.collapsible?" ol-uncollapsible":" ol-collapsed");var r=document.createElement("button");r.setAttribute("type","button"),r.addEventListener("click",function(){this.toggle()}.bind(this)),t.appendChild(r),(r=document.createElement("button")).setAttribute("type","button"),r.className="ol-closebox",r.addEventListener("click",function(){this.toggle()}.bind(this)),t.appendChild(r)}this._legend=e.legend,this._legend.getCanvas().className="ol-legendImg",t.appendChild(this._legend.getCanvas()),t.appendChild(this._legend.getListElement()),!1!==e.collapsible&&!1===e.collapsed&&this.show(),this._legend.on("select",function(e){this.dispatchEvent(e)}.bind(this)),this._legend.on("refresh",function(){if(this._onCanvas&&this.getMap())try{this.getMap().renderSync()}catch(e){}}.bind(this))}getLegend(){return this._legend}setCanvas(e){if(this._onCanvas=e,this.element.style.visibility=e?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch(e){}}onCanvas(){return!!this._onCanvas}_draw(e){if(this._onCanvas&&!this.element.classList.contains("ol-collapsed")){var t=this._legend.getCanvas(),r=this.getContext(e),i=r.canvas.height-t.height;r.save(),r.rect(0,i,t.width,t.height);var n="#fff";this._legend.getTextStyle().getBackgroundFill()&&(n=(0,f.asString)(this._legend.getTextStyle().getBackgroundFill().getColor())),r.fillStyle=r.strokeStyle=n,r.lineWidth=10,r.lineJoin="round",r.stroke(),r.clearRect(0,i,t.width,t.height),r.fill(),r.drawImage(t,0,i),r.restore()}}show(){if(this.element.classList.contains("ol-collapsed")&&(this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:!1}),this.getMap()))try{this.getMap().renderSync()}catch(e){}}hide(){if(!this.element.classList.contains("ol-collapsed")&&(this.element.classList.add("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:!0}),this.getMap()))try{this.getMap().renderSync()}catch(e){}}collapse(e){!1===e?this.show():this.hide()}isCollapsed(){return this.element.classList.contains("ol-collapsed")}toggle(){if(this.element.classList.toggle("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:this.element.classList.contains("ol-collapsed")}),this.getMap())try{this.getMap().renderSync()}catch(e){}}},dr=(m=n("4DafG"),p=n("iQyfo"),class extends m.default{constructor(e){e=e||{};var t=p.default.create("DIV",{className:e.className||"ol-print"});super({element:t,target:e.target}),e.target||(t.classList.add("ol-unselectable","ol-control"),p.default.create("BUTTON",{type:"button",title:e.title||"Print",click:function(){this.print()}.bind(this),parent:t})),this.set("immediate",e.immediate),this.set("imageType",e.imageType||"image/jpeg"),this.set("quality",e.quality||.8),this.set("orientation",e.orientation)}toClipboard(e,t){try{e.canvas.toBlob((function(e){try{navigator.clipboard.write([new window.ClipboardItem(Object.defineProperty({},e.type,{value:e,enumerable:!0}))]),"function"==typeof t&&t(!0)}catch(e){"function"==typeof t&&t(!1)}}))}catch(e){"function"==typeof t&&t(!1)}}copyMap(e,t){this.once("print",function(e){this.toClipboard(e,t)}.bind(this)),this.print(e)}_getCanvas(e,t,r){var i;if(e.context)r=e.context.canvas;else{if(r)i=r.getContext("2d");else{r=document.createElement("canvas");var n=this.getMap().getSize();r.width=n[0],r.height=n[1],i=r.getContext("2d"),/jp.*g$/.test(t)&&(i.fillStyle=this.get("bgColor")||"white",i.fillRect(0,0,r.width,r.height))}this.getMap().getViewport().querySelectorAll(".ol-layers canvas, canvas.ol-fixedoverlay").forEach(function(e){if(e.width){if(i.save(),"0"===e.parentNode.style.opacity)return;i.globalAlpha=parseFloat(e.parentNode.style.opacity)||1,"multiply"===p.default.getStyle(e.parentNode,"mix-blend-mode")&&(i.globalCompositeOperation="multiply");var t=p.default.getStyle(e,"transform")||p.default.getStyle(e,"-webkit-transform");/^matrix/.test(t)?((t=t.replace(/^matrix\(|\)$/g,"").split(",")).forEach((function(e,r){t[r]=parseFloat(e)})),i.transform(t[0],t[1],t[2],t[3],t[4],t[5]),i.drawImage(e,0,0)):i.drawImage(e,0,0,p.default.getStyle(e,"width"),p.default.getStyle(e,"height")),i.restore()}}.bind(this))}return r}fastPrint(e,t){e=e||{},this._ol6?requestAnimationFrame(function(){t(this._getCanvas({},e.imageType,e.canvas))}.bind(this)):(this.getMap().once("postcompose",function(r){r.context||(this._ol6=!0),t(this._getCanvas(r,e.imageType,e.canvas))}.bind(this)),this.getMap().render())}print(e){var t=(e=e||{}).imageType||this.get("imageType"),r=e.quality||this.get("quality");if(this.getMap()){if("silent"!==e.immediate&&this.dispatchEvent(Object.assign({type:"printing"},e)),!e.immediate)return void setTimeout(function(){(e=Object.assign({},e)).immediate="silent",this.print(e)}.bind(this),200);this.getMap().once(this.get("immediate")?"postcompose":"rendercomplete",function(i){var n,s,a,o,l=this._getCanvas(i,t),h=e.size||[210,297],u=e.format||"a4",c=e.orient||this.get("orientation"),f="number"==typeof e.margin?e.margin:10;if(l){"landscape"!==c&&"portrait"!==c&&(c=l.width>l.height?"landscape":"portrait"),"landscape"===c&&(h=[h[1],h[0]]);var d=Math.min((h[0]-2*f)/l.width,(h[1]-2*f)/l.height);n=d*l.width,s=d*l.height,a=[(h[0]-n)/2,(h[1]-s)/2]}try{o=l?l.toDataURL(t,r):null}catch(e){return void this.dispatchEvent({type:"error",canvas:l})}var p=Object.assign({type:"print",print:{format:u,orientation:c,unit:"mm",size:h,position:a,imageWidth:n,imageHeight:s},image:o,imageType:t,quality:r,canvas:l},e);this.dispatchEvent(p)}.bind(this)),this.getMap().render()}}}),pr=(f=n("lqNjm"),d=n("6sFdl"),p=n("iQyfo"),class extends d.default{constructor(e){e=e||{},super({element:p.default.create("DIV",{className:(e.className||"")+" ol-control-title ol-unselectable",style:{display:"block",visibility:"hidden"}}),style:e.style}),this.setTitle(e.title||""),this.setVisible(!1!==e.visible),this.element.style.font=this.getTextFont()}setStyle(e){super.setStyle(e),this.element&&(this.element.style.font=this.getTextFont()),this.getMap()&&this.getMap().render()}setTitle(e){if(this.element.textContent=e,this.set("title",e),this.getMap())try{this.getMap().renderSync()}catch(e){}}getTitle(){return this.get("title")}setVisible(e){if(this.element.style.display=e?"block":"none",this.getMap())try{this.getMap().renderSync()}catch(e){}}getVisible(){return"none"!==this.element.style.display}_draw(e){if(this.getVisible()){var t=this.getContext(e);if(t){var r=e.frameState.pixelRatio;t.save(),t.scale(r,r);var i=this.element.getBoundingClientRect(),n=this.getMap().getViewport().getBoundingClientRect(),s=this.getMap().getSize()[0]/n.width;t.translate(Math.round((i.left-n.left)*s),Math.round((i.top-n.top)*s));var a=this.element.clientHeight,o=this.element.clientWidth,l=o/2;t.beginPath(),t.fillStyle=(0,f.asString)(this.getFill().getColor()),t.rect(0,0,o,a),t.fill(),t.closePath(),t.beginPath(),t.fillStyle=(0,f.asString)(this.getTextFill().getColor()),t.strokeStyle=(0,f.asString)(this.getTextStroke().getColor()),t.lineWidth=this.getTextStroke().getWidth(),t.textAlign="center",t.textBaseline="middle",t.font=this.getTextFont(),t.lineWidth&&t.strokeText(this.getTitle(),l,a/2),t.fillText(this.getTitle(),l,a/2),t.closePath(),t.restore()}}}}),gr=n("7qu5m"),mr=(tr=n("gzr8q"),function(e,t){var r=e.getView(),i=r.getProjection(),n=r.getCenter(),s=e.getPixelFromCoordinate(n);s[1]+=1;var a=e.getCoordinateFromPixel(s),o=(0,gr.getDistance)((0,tr.transform)(n,i,"EPSG:4326"),(0,tr.transform)(a,i,"EPSG:4326"));return o*=(t||96)/.0254}),yr=function(e,t,r){if(e&&t){var i=t;if("string"==typeof t&&((i=t.split("/")[1])||(i=t),i=i.replace(/[^\d]/g,""),i=parseInt(i)),!i)return;var n=e.getView(),s=n.getProjection(),a=n.getCenter(),o=e.getPixelFromCoordinate(a);o[1]+=1;var l=e.getCoordinateFromPixel(o),h=(0,gr.getDistance)((0,tr.transform)(a,s,"EPSG:4326"),(0,tr.transform)(l,s,"EPSG:4326"));return h*=(r||96)/.0254,n.setResolution(n.getResolution()*i/h),i}},vr=(d=n("6sFdl"),c=n("l9IGS"),$t=n("d5AAH"),p=n("iQyfo"),class extends d.default{constructor(e){e=e||{};var t=document.createElement("div");t.className="ol-control ol-compassctrl ol-unselectable ol-hidden"+(e.className?" "+e.className:""),t.style.position="absolute",t.style.visibility="hidden";var r=e.style instanceof $t.default?new(0,c.default)({stroke:e.style}):e.style;e.style||(r=new(0,c.default)({stroke:new(0,$t.default)({width:0})})),super({element:t,style:r}),this.set("rotateVithView",!1!==e.rotateWithView),this.setVisible(!1!==e.visible),this.setImage(e.image||e.src)}setImage(e){if(e instanceof Image)this.img_=e,this.img_.onload=function(){if(this.getMap())try{this.getMap().renderSync()}catch(e){}}.bind(this);else if("string"==typeof e)switch(e){case"compact":this.img_=this.compactCompass_(this.element.clientWidth,this.getStroke().getColor());break;case"default":this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor());break;default:this.img_=new Image,this.img_.onload=function(){if(this.getMap())try{this.getMap().renderSync()}catch(e){}}.bind(this),this.img_.src=e}else this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor())}compactCompass_(e,t){var r=document.createElement("canvas"),i=r.getContext("2d"),n=(e=r.width=r.height=e||150)/2;return i.translate(n,n),i.fillStyle=t||"#963",i.lineWidth=5,i.lineJoin=i.lineCap="round",i.font="bold "+.4*n+"px sans-serif",i.textBaseline="bottom",i.textAlign="center",i.strokeStyle="#fff",i.globalAlpha=.75,i.strokeText("N",0,-n/2),i.globalAlpha=1,i.fillText("N",0,-n/2),i.beginPath(),i.moveTo(0,n/4),i.lineTo(n/3,n/2),i.lineTo(0,-n/2),i.lineTo(-n/3,n/2),i.lineTo(0,n/4),i.lineWidth=12,i.fillStyle="#fff",i.globalAlpha=.75,i.fill(),i.stroke(),i.globalAlpha=1,i.fillStyle=i.strokeStyle=t||"#963",i.lineWidth=5,i.beginPath(),i.moveTo(0,n/4),i.lineTo(0,-n/2),i.lineTo(n/3,n/2),i.lineTo(0,n/4),i.fill(),i.stroke(),i.beginPath(),i.moveTo(0,n/4),i.lineTo(0,-n/2),i.lineTo(-n/3,n/2),i.lineTo(0,n/4),i.stroke(),r}defaultCompass_(e,t){var r=document.createElement("canvas"),i=r.getContext("2d"),n=(e=r.width=r.height=e||150)/2,s=.22*n;function a(e,r){i.fillStyle=t||"#963",i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(r,r),i.moveTo(0,0),i.lineTo(-e,0),i.lineTo(-r,-r),i.moveTo(0,0),i.lineTo(0,e),i.lineTo(-r,r),i.moveTo(0,0),i.lineTo(0,-e),i.lineTo(r,-r),i.moveTo(0,0),i.fill(),i.stroke()}function o(e,t){i.globalCompositeOperation="destination-out",i.fillStyle="#fff",i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(t,-t),i.moveTo(0,0),i.lineTo(-e,0),i.lineTo(-t,t),i.moveTo(0,0),i.lineTo(0,e),i.lineTo(t,t),i.moveTo(0,0),i.lineTo(0,-e),i.lineTo(-t,-t),i.moveTo(0,0),i.fill(),i.globalCompositeOperation="source-over",i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(t,-t),i.moveTo(0,0),i.lineTo(-e,0),i.lineTo(-t,t),i.moveTo(0,0),i.lineTo(0,e),i.lineTo(t,t),i.moveTo(0,0),i.lineTo(0,-e),i.lineTo(-t,-t),i.moveTo(0,0),i.stroke()}return i.translate(n,n),i.strokeStyle=t||"#963",i.lineWidth=1.5,i.beginPath(),i.arc(0,0,.41*e,0,2*Math.PI),i.arc(0,0,.44*e,0,2*Math.PI),i.stroke(),i.rotate(Math.PI/4),a(.9*n,.8*s),o(.9*n,.8*s),i.rotate(-Math.PI/4),a(n,s),o(n,s),r}getVisible(){return"block"===p.default.getStyle(this.element,"display")}setVisible(e){e?this.element.classList.add("ol-visible"):this.element.classList.remove("ol-visible"),this.getMap()&&this.getMap().render()}_draw(e){var t=this.getContext(e);if(t&&this.getVisible()){var r,i=t.canvas,n=[];for(r=0;r<8;r++)n[r]=[Math.cos(Math.PI*r/8),Math.sin(Math.PI*r/8)];var s=e.frameState.pixelRatio;t.save(),t.scale(s,s);var a=this.element.clientWidth,o=this.element.clientHeight,l=this.element.offsetLeft,h=this.element.offsetTop,u=this.img_,c=e.frameState.viewState.rotation;if(t.beginPath(),t.translate(l+a/2,h+o/2),this.get("rotateVithView")&&t.rotate(c),this.getStroke().getWidth()){t.beginPath(),t.strokeStyle=this.getStroke().getColor(),t.lineWidth=this.getStroke().getWidth();var f=Math.max(i.width,i.height);for(r=0;r<8;r++)t.moveTo(-n[r][0]*f,-n[r][1]*f),t.lineTo(n[r][0]*f,n[r][1]*f);t.stroke()}u.width&&t.drawImage(u,-a/2,-o/2,a,o),t.closePath(),t.restore()}}}),_r=class extends m.default{constructor(e){e=e||{};var t=p.default.create("DIV",{className:(e.className||"ol-print")+" ol-unselectable ol-control"});super({element:t}),this._lang=e.lang||"en",p.default.create("BUTTON",{type:"button",title:e.title||"Print",click:function(){this.print()}.bind(this),parent:t}),e.openWindow&&this.on("print",(function(e){e.canvas&&window.open().document.write('<img src="'+e.canvas.toDataURL()+'"/>')})),e.target=p.default.create("DIV");var r=this._printCtrl=new dr(e);r.on(["print","error","printing"],function(e){n.setAttribute("data-status",e.type),e.clipboard||this.dispatchEvent(e)}.bind(this)),this._compass=new vr({src:e.northImage||"compact",visible:!1,className:"olext-print-compass",style:new(0,$t.default)({color:"#333",width:0})});var i=this._printDialog=new(0,Kt.default)({target:document.body,closeBox:!0,className:"ol-ext-print-dialog"}),n=i.getContentElement();this._input={};var s=p.default.create("DIV",{className:"ol-print-param",parent:n});this._pages=[p.default.create("DIV",{className:"ol-page"})];var a=p.default.create("DIV",{className:"ol-map",parent:this._pages[0]});p.default.create("DIV",{html:this._pages[0],className:"ol-print-map",parent:n}),p.default.create("H2",{html:this.i18n("title"),parent:s});var o=p.default.create("UL",{parent:s}),l=p.default.create("LI",{className:"ol-orientation",parent:o});this._input.orientation={list:l};var u,c=p.default.create("LABEL",{className:"portrait",parent:l});this._input.orientation.portrait=p.default.create("INPUT",{type:"radio",name:"ol-print-orientation",value:"portrait",checked:!0,on:{change:function(e){this.setOrientation(e.target.value)}.bind(this)},parent:c}),p.default.create("SPAN",{html:this.i18n("portrait"),parent:c}),c=p.default.create("LABEL",{className:"landscape",parent:l}),this._input.orientation.landscape=p.default.create("INPUT",{type:"radio",name:"ol-print-orientation",value:"landscape",on:{change:function(e){this.setOrientation(e.target.value)}.bind(this)},parent:c}),p.default.create("SPAN",{html:this.i18n("landscape"),parent:c}),l=p.default.create("LI",{html:p.default.create("LABEL",{html:this.i18n("size")}),className:"ol-size",parent:o});var f=this._input.size=p.default.create("SELECT",{on:{change:function(){this.setSize(f.value||S)}.bind(this)},parent:l});for(u in this.paperSize)p.default.create("OPTION",{html:u+(this.paperSize[u]?" - "+this.paperSize[u][0]+"x"+this.paperSize[u][1]+" mm":this.i18n("custom")),value:u,parent:f});l=p.default.create("LI",{html:p.default.create("LABEL",{html:this.i18n("margin")}),className:"ol-margin",parent:o});var d=this._input.margin=p.default.create("SELECT",{on:{change:function(){this.setMargin(d.value)}.bind(this)},parent:l});for(u in this.marginSize)p.default.create("OPTION",{html:this.i18n(u)+" - "+this.marginSize[u]+" mm",value:this.marginSize[u],parent:d});l=p.default.create("LI",{html:p.default.create("LABEL",{html:this.i18n("scale")}),className:"ol-scale",parent:o});var g=this._input.scale=p.default.create("SELECT",{on:{change:function(){this.setScale(parseInt(g.value))}.bind(this)},parent:l});Object.keys(this.scales).forEach(function(e){p.default.create("OPTION",{html:this.scales[e],value:e,parent:g})}.bind(this)),l=p.default.create("LI",{className:"ol-legend",parent:o});var m=p.default.createSwitch({html:this.i18n("legend"),checked:!1,on:{change:function(){R.legend.control.setCanvas(m.checked)}.bind(this)},parent:l});l=p.default.create("LI",{className:"ol-print-north",parent:o});var y=this._input.north=p.default.createSwitch({html:this.i18n("north"),checked:"checked",on:{change:function(){y.checked?this._compass.element.classList.add("ol-print-compass"):this._compass.element.classList.remove("ol-print-compass"),this.getMap().render()}.bind(this)},parent:l});l=p.default.create("LI",{className:"ol-print-title",parent:o});var v=p.default.createSwitch({html:this.i18n("mapTitle"),checked:!1,on:{change:function(e){R.title.control.setVisible(e.target.checked)}.bind(this)},parent:l}),_=p.default.create("INPUT",{type:"text",placeholder:this.i18n("mapTitle"),on:{keydown:function(e){13===e.keyCode&&e.preventDefault()},keyup:function(){R.title.control.setTitle(_.value)},change:function(){R.title.control.setTitle(_.value)}.bind(this)},parent:l}),x=p.default.create("DIV",{className:"ol-user-param",parent:s});l=p.default.create("LI",{className:"ol-saveas",parent:o});var b=p.default.create("DIV",{html:this.i18n("copied"),className:"ol-clipboard-copy",parent:l}),E=p.default.create("SELECT",{on:{change:function(){if(this.formats[E.value].clipboard)r.copyMap(this.formats[E.value],(function(e){e&&(b.classList.add("visible"),setTimeout((function(){b.classList.remove("visible")}),1e3))}));else{var e="string"==typeof this.getSize()?this.getSize():null,t=Object.assign({format:e,size:e?this.paperSize[e]:null,orient:this.getOrientation(),margin:this.getMargin()},this.formats[E.value]);r.print(t)}E.value=""}.bind(this)},parent:l});p.default.create("OPTION",{html:this.i18n("saveas"),style:{display:"none"},value:"",parent:E}),this.formats.forEach(function(t,r){if(t.pdf){if(!1===e.pdf)return}else if(t.clipboard){if(!1===e.copy)return}else if(!1===e.save)return;p.default.create("OPTION",{html:t.title,value:r,parent:E})}.bind(this)),l=p.default.create("LI",{className:"ol-savelegend",parent:o});var w=p.default.create("DIV",{html:this.i18n("copied"),className:"ol-clipboard-copy",parent:l}),T=p.default.create("SELECT",{on:{change:function(){var e=R.legend.control.getLegend().getCanvas(),t=document.createElement("CANVAS");t.width=e.width,t.height=e.height;var r,i=t.getContext("2d");if(i.fillStyle="#fff",i.fillRect(0,0,t.width,t.height),i.drawImage(e,0,0),this.formats[T.value].clipboard)t.toBlob((function(e){try{navigator.clipboard.write([new window.ClipboardItem(Object.defineProperty({},e.type,{value:e,enumerable:!0}))]),w.classList.add("visible"),setTimeout((function(){w.classList.remove("visible")}),1e3)}catch(e){}}),"image/png");else try{r=t.toDataURL(this.formats[T.value].imageType,this.formats[T.value].quality);var n="string"==typeof this.getSize()?this.getSize():"A4",s=t.width/96*25.4,a=t.height/96*25.4,o=this.paperSize[n];"landscape"===this.getOrientation()&&(o=[o[1],o[0]]);var l=[(o[0]-s)/2,(o[1]-a)/2];this.dispatchEvent({type:"print",print:{legend:!0,format:n,orientation:this.getOrientation(),unit:"mm",size:this.paperSize[n],position:l,imageWidth:s,imageHeight:a},image:r,imageType:this.formats[T.value].imageType,pdf:this.formats[T.value].pdf,quality:this.formats[T.value].quality,canvas:t})}catch(e){}T.value=""}.bind(this)},parent:l});p.default.create("OPTION",{html:this.i18n("saveLegend"),style:{display:"none"},value:"",parent:T}),this.formats.forEach(function(e,t){p.default.create("OPTION",{html:e.title,value:t,parent:T})}.bind(this));var L,S,I,A=p.default.create("DIV",{className:"ol-ext-buttons",parent:s});p.default.create("BUTTON",{html:this.i18n("printBt"),type:"submit",click:function(e){e.preventDefault(),window.print()},parent:A}),p.default.create("BUTTON",{html:this.i18n("cancel"),type:"button",click:function(){i.hide()},parent:A}),p.default.create("DIV",{html:this.i18n("errorMsg"),className:"ol-error",parent:s});var R={};i.on("show",function(){this.dispatchEvent({type:"show",userElement:x,dialog:this._printDialog,page:this.getPage()});var e=this.getMap();e&&(document.body.classList.add("ol-print-document"),L=e.getTargetElement(),S=e.getSize(),"string"==typeof this.getSize()?this.setSize(this.getSize()):this.setSize(S),e.setTarget(a),I&&(0,h.unByKey)(I),I=e.on("moveend",function(){this.setScale(mr(e))}.bind(this)),this.setScale(mr(e)),R={},this.getMap().getControls().forEach(function(e){e instanceof fr&&(R.legend={control:e}),e instanceof pr&&(R.title={control:e}),e instanceof vr&&(R.compass?e.element.classList.remove("ol-print-compass"):(this._input.north.checked?e.element.classList.add("ol-print-compass"):e.element.classList.remove("ol-print-compass"),this._compass=e,R.compass={control:e}))}.bind(this)),R.title?(v.checked=R.title.isVisible=R.title.control.getVisible(),_.value=R.title.control.getTitle(),v.parentNode.parentNode.classList.remove("hidden")):v.parentNode.parentNode.classList.add("hidden"),R.legend?(R.legend.ison=R.legend.control.onCanvas(),R.legend.collapsed=R.legend.control.isCollapsed(),R.legend.control.collapse(!1),T.parentNode.classList.remove("hidden"),m.parentNode.parentNode.classList.remove("hidden"),m.checked=!R.legend.collapsed,R.legend.control.setCanvas(!R.legend.collapsed)):(T.parentNode.classList.add("hidden"),m.parentNode.parentNode.classList.add("hidden")))}.bind(this)),i.on("hide",function(){document.body.classList.remove("ol-print-document"),L&&(this.getMap().setTarget(L),L=null,I&&(0,h.unByKey)(I),R.title&&R.title.control.setVisible(R.title.isVisible),R.legend&&(R.legend.control.setCanvas(R.legend.ison),R.legend.control.collapse(R.legend.collapsed)),this.dispatchEvent({type:"hide"}))}.bind(this)),window.addEventListener("resize",function(){this.setSize()}.bind(this)),e.saveAs&&this.on("print",(function(t){t.pdf||t.canvas.toBlob((function(r){var i=(t.print.legend?"legend.":"map.")+t.imageType.replace("image/","");e.saveAs(r,i)}),t.imageType,t.quality)})),e.jsPDF&&this.on("print",(function(t){if(t.pdf){var r=new e.jsPDF({orientation:t.print.orientation,unit:t.print.unit,format:t.print.size});r.addImage(t.image,"JPEG",t.print.position[0],t.print.position[0],t.print.imageWidth,t.print.imageHeight),r.save(t.print.legend?"legend.pdf":"map.pdf")}}))}static addLang(e,t){_r.prototype._labels[e]=t}isOpen(){return this._printDialog.isOpen()}i18n(e){var t=this._labels.en[e]||"bad param";return this._labels[this._lang]&&this._labels[this._lang][e]&&(t=this._labels[this._lang][e]),t}getOrientation(){return this._orientation||"portrait"}setOrientation(e){this._orientation="landscape"===e?"landscape":"portrait",this._input.orientation[this._orientation].checked=!0,this.setSize()}getMargin(){return this._margin||0}setMargin(e){this._margin=e,this._input.margin.value=e,this.setSize()}getSize(){return this._size}setSize(e){if(this._printDialog.getContentElement().setAttribute("data-status",""),e?this._size=e:e=this._size,e){if("string"==typeof e){for(var t in this.paperSize)t&&new RegExp(t,"i").test(e)&&(e=t);this.paperSize[e]||(e=this._size="A4"),this._input.size.value=e,e=[Math.trunc(96*this.paperSize[e][0]/25.4),Math.trunc(96*this.paperSize[e][1]/25.4)],"landscape"===this.getOrientation()&&(e=[e[1],e[0]]),this.getPage().classList.remove("margin")}else this._input.size.value="",this.getPage().classList.add("margin");var r=this.getPage(),i=r.parentNode.getBoundingClientRect(),n=(i.width-40)/e[0],s=(i.height-40)/e[1],a=Math.min(n,s,1);r.style.width=e[0]+"px",r.style.height=e[1]+"px",r.style["-webkit-transform"]=r.style.transform="translate(-50%,-50%) scale("+a+")";var o=Math.round(5/a);r.style["-webkit-box-shadow"]=r.style["box-shadow"]=o+"px "+o+"px "+o+"px rgba(0,0,0,.6)",r.style.padding=96*this.getMargin()/25.4+"px",this.getMap()&&this.getMap().updateSize(),this.dispatchEvent({type:"dialog:refresh"})}}getContentElement(){return this._printDialog.getContentElement()}getUserElement(){return this._printDialog.getContentElement().querySelector(".ol-user-param")}getPage(){return this._pages[0]}setMap(e){this.getMap()&&(this.getMap().removeControl(this._compass),this.getMap().removeControl(this._printCtrl),this.getMap().removeControl(this._printDialog)),super.setMap(e),this.getMap()&&(this.getMap().addControl(this._compass),this.getMap().addControl(this._printCtrl),this.getMap().addControl(this._printDialog))}setScale(e){yr(this.getMap(),e),this._input.scale.value=" "+100*Math.round(e/100)}getScale(){return mr(this.getMap())}print(e){(e=e||{}).size&&this.setSize(e.size),e.scale&&this.setScale(e.scale),e.orientation&&this.setOrientation(e.orientation),e.margin&&this.setMargin(e.margin),this._printDialog.show()}getrintControl(){return this._printCtrl}};_r.prototype._labels={en:{title:"Print",orientation:"Orientation",portrait:"Portrait",landscape:"Landscape",size:"Page size",custom:"screen size",margin:"Margin",scale:"Scale",legend:"Legend",north:"North arrow",mapTitle:"Map title",saveas:"Save as...",saveLegend:"Save legend...",copied:"✔ Copied to clipboard",errorMsg:"Can't save map canvas...",printBt:"Print...",clipboardFormat:"copy to clipboard...",jpegFormat:"save as jpeg",pngFormat:"save as png",pdfFormat:"save as pdf",none:"none",small:"small",large:"large",cancel:"cancel"},fr:{title:"Imprimer",orientation:"Orientation",portrait:"Portrait",landscape:"Paysage",size:"Taille du papier",custom:"taille écran",margin:"Marges",scale:"Echelle",legend:"Légende",north:"Flèche du nord",mapTitle:"Titre de la carte",saveas:"Enregistrer sous...",saveLegend:"Enregistrer la légende...",copied:"✔ Carte copiée",errorMsg:"Impossible d'enregistrer la carte",printBt:"Imprimer",clipboardFormat:"copier dans le presse-papier...",jpegFormat:"enregistrer un jpeg",pngFormat:"enregistrer un png",pdfFormat:"enregistrer un pdf",none:"aucune",small:"petites",large:"larges",cancel:"annuler"},de:{title:"Drucken",orientation:"Ausrichtung",portrait:"Hochformat",landscape:"Querformat",size:"Papierformat",custom:"Bildschirmgröße",margin:"Rand",scale:"Maßstab",legend:"Legende",north:"Nordpfeil",mapTitle:"Kartentitel",saveas:"Speichern als...",saveLegend:"Legende speichern...",copied:"✔ In die Zwischenablage kopiert",errorMsg:"Kann Karte nicht speichern...",printBt:"Drucken...",clipboardFormat:"in die Zwischenablage kopieren...",jpegFormat:"speichern als jpeg",pngFormat:"speichern als png",pdfFormat:"speichern als pdf",none:"kein",small:"klein",large:"groß",cancel:"abbrechen"},zh:{title:"打印",orientation:"方向",portrait:"纵向",landscape:"横向",size:"页面大小",custom:"屏幕大小",margin:"外边距",scale:"尺度",legend:"图例",north:"指北针",mapTitle:"地图名字",saveas:"保存为...",saveLegend:"保存图例为...",copied:"✔ 已复制到剪贴板",errorMsg:"无法保存地图...",printBt:"打印...",cancel:"取消"}},_r.prototype.paperSize={"":null,A0:[841,1189],A1:[594,841],A2:[420,594],A3:[297,420],A4:[210,297],"US Letter":[215.9,279.4],A5:[148,210],B4:[257,364],B5:[182,257]},_r.prototype.marginSize={none:0,small:5,large:10},_r.prototype.formats=[{title:"clipboardFormat",imageType:"image/png",clipboard:!0},{title:"jpegFormat",imageType:"image/jpeg",quality:.8},{title:"pngFormat",imageType:"image/png",quality:.8},{title:"pdfFormat",imageType:"image/jpeg",pdf:!0}],_r.prototype.scales={" 5000":"1/5.000"," 10000":"1/10.000"," 25000":"1/25.000"," 50000":"1/50.000"," 100000":"1/100.000"," 250000":"1/250.000"," 1000000":"1/1.000.000"};var xr=_r;(0,o.default)(e("<div> <h2> Day 2: lines Flow lines style </h2> <p> A simple map with layer switcher, scale line and print control. </p> </div>")),a.default.getView().setZoom(9),a.default.getView().setCenter([-323699,6074344]);const br=new(0,s.default)({layer:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2"});a.default.addLayer(br);const Er=new(0,s.default)({layer:"ORTHOIMAGERY.ORTHOPHOTOS"});a.default.addLayer(Er);const wr=new(0,s.default)({layer:"TRANSPORTNETWORKS.ROADS"});a.default.addLayer(wr),a.default.addControl(new(0,l.default)),a.default.addControl(new g({canvas:!0})),a.default.addControl(new Yt),a.default.addControl(new xr);